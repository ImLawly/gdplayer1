<?php
/*   __________________________________________________
    |  Obfuscated by YAK Pro - Php Obfuscator  2.0.16  |
    |              on 2025-05-18 20:27:36              |
    |    GitHub: https://github.com/pk-fr/yakpro-po    |
    |__________________________________________________|
*/
/*
Copyright @ 2020 - 2025 GDPlayer v4.7.1. https://gdplayer.to | https://t.me/gdplayerto
*/
 namespace GDPlayer; use GDPlayer\{InstanceCache, Security}; use GDPlayer\Model\{Session, User}; class Login { private Security $security; protected Session $session; protected User $user; protected $secure = false; protected $isLoggedIn = false; protected $domain = ''; protected $userIP = ''; protected $sessionStarted = false; public function __construct() { goto hc6xY; dHhYg: $this->secure = isSSL(); goto EDiDE; Nxloj: $this->session = Session::getInstance(); goto iKuRb; EDiDE: $this->domain = "\56" . parse_url(BASE_URL, PHP_URL_HOST); goto YlcDh; Gw3JW: $this->security = new Security(); goto Nxloj; iKuRb: $this->user = User::getInstance(); goto dHhYg; YlcDh: $this->userIP = getUserIP(); goto ycP94; hc6xY: session_write_close(); goto Gw3JW; ycP94: } private function startSessionIfNeeded() : bool { goto ZZuxx; d3ujX: session_name("\x5f\163"); goto lN2cl; LsxVR: $this->sessionStarted = true; goto ScRoQ; lN2cl: session_start(); goto LsxVR; ScRoQ: v84mf: goto CSP6O; CSP6O: return true; goto Xm0Hb; ZZuxx: $this->sessionStarted = false; goto NZKoX; NZKoX: if (!(session_status() === PHP_SESSION_NONE && !headers_sent())) { goto v84mf; } goto d3ujX; Xm0Hb: } private function closeSessionIfNeeded() : void { goto fVGMh; yv9cs: session_write_close(); goto DfJMs; dDBrQ: $this->sessionStarted = false; goto qJ07R; fVGMh: session_write_close(); goto d5udI; qJ07R: c_Cyl: goto yv9cs; d5udI: if (!($this->sessionStarted && session_status() === PHP_SESSION_ACTIVE)) { goto c_Cyl; } goto dDBrQ; DfJMs: } public function loginRegisterTokenValidation(string $redirectUrl) { goto ICu4y; VUnHs: wXCVy: goto lY1bm; Dzyxy: goto wXCVy; goto ZR0TZ; n1sjv: $expires = sanitizeInt($token[1]); goto dS4SO; Zic1r: if (!empty($email)) { goto yP__M; } goto LP7xC; pW8l2: $alertIcon = "\74\x69\x20\143\154\x61\x73\x73\x3d\x22\x66\x61\x73\40\x66\141\55\164\x69\x6d\145\163\40\x6d\x72\55\62\42\x3e\x3c\x2f\x69\76"; goto Bpd4o; NkO6E: $resendLink = $this->security->encryptURL($email . "\174" . $expires); goto HnQXe; jTxIa: $invalidToken = true; goto CzrS1; ASPv0: QvYme: goto het8t; eapVM: $invalidToken = false; goto zgq3G; ZR0TZ: ielt3: goto vnNVW; tuMLV: yP__M: goto xIgrI; kxrYT: $invalid = false; goto eapVM; G7z44: $alert .= $alertIcon . "\x54\x68\145\40\164\x6f\x6b\x65\156\40\151\163\x20\x69\156\x76\141\154\151\144\74\142\162\76"; goto uG4Hw; Bpd4o: $token = array_pad(explode("\x7c", $this->security->decryptURL($_GET["\164\x6f\153\145\156"])), 2, ''); goto bUKfL; zgq3G: $alert = ''; goto pW8l2; vnNVW: $expires = time() + 600; goto NkO6E; U_LWS: if (!($now > $expires)) { goto oEKt8; } goto jTxIa; ICu4y: session_write_close(); goto kxrYT; CzrS1: $invalid = true; goto G7z44; hfkes: Vnslx: goto U_LWS; lY1bm: return true; goto ntviC; het8t: createAlert("\144\141\x6e\x67\x65\162", $alert, $redirectUrl); goto VUnHs; EWXwB: goto wXCVy; goto ASPv0; Edmek: $alert .= $alertIcon . "\x54\x68\145\40\x65\x6d\141\x69\154\x20\x69\163\40\151\156\x76\x61\154\x69\144\x3c\x62\x72\x3e"; goto hfkes; LP7xC: $invalid = true; goto Dw3o_; dS4SO: $now = time(); goto Zic1r; HnQXe: createAlert("\x64\141\156\x67\145\162", "\x54\150\x65\40\162\145\147\x69\163\164\x72\x61\x74\x69\157\156\x20\143\x6f\x6e\x66\x69\x72\155\x61\164\x69\157\156\x20\x6c\x69\x6e\153\40\x68\x61\163\x20\x65\x78\x70\x69\x72\145\x64\54\40\x3c\141\40\150\x72\x65\x66\x3d\42{$resendLink}\42\76\160\x6c\x65\x61\163\x65\40\162\145\163\145\x6e\x64\40\x74\x68\145\x20\154\151\x6e\x6b\74\x2f\x61\76", $redirectUrl); goto EWXwB; bUKfL: $email = sanitizeEmail($token[0]); goto n1sjv; xIgrI: if (validateEmail($email)) { goto Vnslx; } goto y4TuJ; u532I: if ($invalidToken) { goto ielt3; } goto oDdNO; oDdNO: if ($invalid) { goto QvYme; } goto Dzyxy; Dw3o_: $alert .= $alertIcon . "\x45\x6d\x61\x69\154\40\x69\163\x20\162\145\161\x75\x69\162\x65\144\x3c\142\162\x3e"; goto tuMLV; y4TuJ: $invalid = true; goto Edmek; uG4Hw: oEKt8: goto u532I; ntviC: } private function usernameValidation(string $username = '') { goto jGddl; JPMBw: $this->closeSessionIfNeeded(); goto NAxRV; u6JlY: return false; goto l87Mr; NAxRV: dTdPZ: goto bltue; iY8I2: $this->isLoggedIn = true; goto jOy3B; sburA: aO46l: goto cPa11; DpdeY: goto YuRUX; goto Mtwmv; MWlC5: YuRUX: goto u6JlY; jOy3B: if (!$this->startSessionIfNeeded()) { goto dTdPZ; } goto UZ0t2; jGddl: session_write_close(); goto M58oV; cPa11: $_SESSION["\165\163\145\162"] = $data; goto JPMBw; A0gaX: $data = $this->user->getOne(); goto SaP2b; qtW2q: $this->saveLoginFailed($username); goto DpdeY; UZ0t2: if (!(session_status() === PHP_SESSION_ACTIVE)) { goto aO46l; } goto HyIlS; bltue: return (array) $data; goto MWlC5; LHxzP: $this->user->setCriteria("\145\x6d\x61\x69\154", $username, "\75", "\x4f\x52"); goto A0gaX; HyIlS: session_regenerate_id(true); goto sburA; SaP2b: if ($data) { goto FDQyq; } goto qtW2q; Mtwmv: FDQyq: goto iY8I2; M58oV: $this->user->setCriteria("\x75\163\145\162", $username); goto LHxzP; l87Mr: } public function tokenValidation(string $token = '') { goto xmZpS; hTcFG: if (isset($data["\x75\163\145\x72\x6e\141\x6d\145"]) && isset($data["\x75\x73\145\x72\141\147\145\x6e\x74"]) && $data["\165\163\145\162\x61\x67\145\156\164"] === $ua) { goto VW32W; } goto cWKYY; O8rPG: InstanceCache::saveDeferred($cache); goto GmCGD; SLZbe: jKqxY: goto IabM6; IabM6: rPfq9: goto aXupG; c1uZg: $this->session->setCriteria("\x65\170\x70\x69\162\x65\144", time(), "\76", "\101\116\x44"); goto LDdF8; PCgtG: BNP2h: goto QgTbH; cWKYY: $this->session->setCriteria("\x74\x6f\153\x65\x6e", $token); goto c1uZg; LDdF8: $this->session->setCriteria("\163\164\x61\x74", 0, "\x3d", "\101\116\x44"); goto EZjxc; xmZpS: session_write_close(); goto AWNL3; GmCGD: $result = $this->usernameValidation($data["\165\x73\x65\x72\156\141\155\145"]); goto PCgtG; QgTbH: goto jKqxY; goto Fcp9J; aXupG: return $result; goto g73SL; NQMfT: $cache->set($data)->expiresAfter(DB_CACHE_TIMEOUT)->addTag("\x73\x65\x73\x73\x69\157\x6e\163"); goto O8rPG; EZjxc: $this->session->setCriteria("\165\x73\x65\162\x61\147\x65\x6e\164", $ua, "\75", "\101\x4e\x44"); goto X1rfz; lsg98: if (empty($token)) { goto rPfq9; } goto vP66d; AWNL3: $result = false; goto Zy1tE; AlIWa: $ua = $_SERVER["\x48\x54\x54\120\137\125\x53\105\x52\x5f\x41\x47\105\x4e\x54"] ?? ''; goto lsg98; jc2jF: $data = $cache->get(); goto hTcFG; qFhD3: if (!$data) { goto BNP2h; } goto NQMfT; Zy1tE: $token = $_COOKIE["\x61\144\x76\x5f\x74\x6f\153\x65\156"] ?? $token; goto AlIWa; Fcp9J: VW32W: goto CH69n; X1rfz: $data = $this->session->getOne(["\x75\163\145\x72\x6e\141\x6d\145", "\165\x73\145\x72\141\147\x65\156\164"]); goto qFhD3; vP66d: $cache = InstanceCache::getItem(keyFilter("\163\145\163\x73\151\x6f\156\137" . $token)); goto jc2jF; CH69n: return $this->usernameValidation($data["\x75\163\x65\162\x6e\x61\x6d\x65"]); goto SLZbe; g73SL: } public function passwordValidation(string $password = '', string $retype_password = '') { goto tR9eC; cKU2o: if (!($password !== $retype_password)) { goto m9SL7; } goto hRFBL; LOgkx: if (!empty($retype_password)) { goto mF_L1; } goto OUYDA; guH3P: if (!(strlen($password) < 8)) { goto LDx8B; } goto GFD64; mPKG1: return implode("\74\x62\x72\76", $alert); goto Pu_Ez; OUYDA: $alert[] = $alertIcon . "\x43\x6f\156\x66\151\162\x6d\x20\160\x61\x73\x73\167\x6f\x72\144\40\x69\163\x20\162\145\x71\x75\151\162\x65\x64"; goto eMNg3; GFD64: $alert[] = $alertIcon . "\120\141\x73\x73\167\157\162\144\x20\x6d\165\x73\x74\40\142\x65\x20\x6c\157\x6e\147\x65\x72\40\164\150\x61\x6e\40\70\x20\x63\150\x61\x72\x61\143\x74\x65\x72\163"; goto LHjPx; hRFBL: $alert[] = $alertIcon . "\103\157\156\x66\x69\162\x6d\40\160\141\163\x73\167\x6f\x72\144\40\x64\x6f\145\163\40\x6e\x6f\x74\40\155\141\x74\x63\x68\40\160\x61\x73\163\x77\157\162\144"; goto fEmHX; LHjPx: LDx8B: goto cKU2o; jUe7v: $alertIcon = "\74\x65\x6d\40\143\x6c\141\x73\x73\x3d\42\x66\x61\x73\40\x66\x61\55\164\x69\x6d\145\163\40\155\162\x2d\62\42\76\74\x2f\x65\155\76"; goto OrT_q; tlNJ1: KzxRt: goto LOgkx; XN3L5: $alert[] = $alertIcon . "\120\x61\x73\x73\x77\x6f\162\144\x20\151\x73\40\x72\145\x71\165\151\x72\145\144"; goto tlNJ1; E61ev: $alert = []; goto jUe7v; tR9eC: session_write_close(); goto E61ev; OrT_q: if (!empty($password)) { goto KzxRt; } goto XN3L5; fEmHX: m9SL7: goto mPKG1; eMNg3: mF_L1: goto guH3P; Pu_Ez: } public function saveLoginFailed(string $username = '') { session_write_close(); return $this->session->insert(["\151\x70" => $this->userIP, "\165\x73\145\x72\x61\x67\x65\156\x74" => $_SERVER["\x48\x54\124\x50\x5f\125\123\x45\x52\x5f\101\107\x45\116\124"], "\x63\162\x65\141\x74\x65\x64" => time(), "\x75\x73\145\162\156\141\x6d\x65" => $username, "\164\157\x6b\145\156" => '']); } public function checkLoginFailed(int $limit = 5) { goto ynzoD; eMImh: $data = $this->session->getNumRows(); goto zAYuP; ynzoD: session_write_close(); goto Y4ONx; Y4ONx: $this->session->setCriteria("\163\x74\141\x74", 0); goto xpxpF; xpxpF: $this->session->setCriteria("\x69\160", $this->userIP); goto NmMV1; U9B9h: $this->session->setLimit($limit); goto eMImh; zAYuP: $rows = $this->session->get(["\143\x72\x65\x61\x74\x65\144"]); goto bQcWz; NmMV1: $this->session->setOrderBy("\143\162\x65\x61\164\x65\144", "\104\105\123\x43"); goto U9B9h; bQcWz: return $data >= $limit && ($rows && time() - $rows[0]["\143\x72\145\x61\x74\145\x64"] < 300); goto T_feg; T_feg: } public function login(string $username = '', string $expiredAt = '') { goto K7UbH; K7UbH: session_write_close(); goto Cibw8; mS8sE: if (!($userData && $this->startSessionIfNeeded())) { goto wPN_W; } goto wkiEz; jHcGu: session_regenerate_id(true); goto Uv9ol; Cibw8: $created = time(); goto w2UUG; XSY2f: setcookie("\141\144\166\137\164\157\153\145\156", $token, ["\x65\x78\x70\x69\x72\145\163" => $expires, "\x70\x61\164\x68" => SLASH, "\144\x6f\x6d\141\151\x6e" => $this->domain, "\163\x65\143\165\x72\x65" => $this->secure, "\150\x74\x74\x70\157\x6e\154\x79" => false, "\163\x61\155\145\163\151\x74\x65" => "\123\x74\x72\151\x63\164"]); goto Rx3CT; Q2pi5: $token = base64_encode(random_bytes(32)); goto A9MHL; A9MHL: $data = ["\x69\160" => $this->userIP, "\165\x73\145\162\x61\147\x65\156\164" => $_SERVER["\x48\124\124\x50\x5f\x55\x53\x45\122\137\x41\x47\x45\x4e\x54"], "\x63\162\145\x61\x74\x65\x64" => $created, "\x75\x73\145\162\x6e\x61\x6d\x65" => $username, "\145\x78\160\151\x72\145\x64" => $expired, "\x74\157\153\x65\156" => $token, "\163\164\x61\164" => 0]; goto g8IUa; w2UUG: $expired = !empty($expiredAt) ? strtotime($expiredAt) : strtotime("\x2b\x36\x20\150\x6f\165\x72\163"); goto FMxR2; JtnBS: $userData = $this->user->getOne(); goto mS8sE; Rx3CT: Araap: goto PW4DB; PW4DB: $this->closeSessionIfNeeded(); goto E4RN4; wkiEz: if (!(session_status() === PHP_SESSION_ACTIVE)) { goto bx2X6; } goto jHcGu; E4RN4: return true; goto MOZ7s; SWx38: if (!$insert) { goto oufr3; } goto D9xVy; VkdTF: $this->user->setCriteria("\x65\x6d\141\x69\x6c", $username, "\75", "\x4f\122"); goto JtnBS; cRXgU: $this->isLoggedIn = true; goto tReAM; cX8Br: return false; goto i_ipX; FMxR2: $expires = !empty($expiredAt) ? strtotime($expiredAt) : 0; goto Q2pi5; MOZ7s: wPN_W: goto L0G12; L0G12: oufr3: goto cX8Br; mZIzf: $_SESSION["\165\x73\145\x72"] = $userData; goto cRXgU; tReAM: if (headers_sent()) { goto Araap; } goto XSY2f; g8IUa: $insert = $this->session->insert($data); goto SWx38; D9xVy: $this->user->setCriteria("\x75\x73\x65\x72", $username); goto VkdTF; Uv9ol: bx2X6: goto mZIzf; i_ipX: } public function logout() { goto Rs17X; OzNr1: register_shutdown_function(fn() => InstanceCache::deleteItemsByTag("\163\x65\x73\x73\151\x6f\156\163")); goto BsqGS; MdyMk: setcookie("\141\x64\x76\x5f\164\x6f\153\x65\156", '', ["\145\170\x70\x69\162\145\x73" => time() - 3600, "\x70\141\x74\150" => SLASH, "\x64\x6f\155\x61\x69\156" => $this->domain, "\x73\x65\x63\x75\x72\x65" => $this->secure, "\x68\164\164\x70\157\x6e\154\x79" => false, "\163\141\x6d\x65\163\x69\x74\x65" => "\x53\x74\x72\151\143\164"]); goto yOyGz; KcI2Q: $this->session->setCriteria("\164\157\x6b\145\156", $_COOKIE["\141\144\166\137\164\x6f\x6b\x65\156"]); goto En3jO; BtRpf: AO7_b: goto cRh2Y; eUvCY: if (headers_sent()) { goto J3cuV; } goto MdyMk; En3jO: $this->session->update(["\x65\170\x70\x69\162\x65\144" => time(), "\163\x74\x61\x74" => 9]); goto eUvCY; leEic: session_write_close(); goto jLS1r; XLkYG: session_destroy(); goto BtRpf; BsqGS: if (!$this->startSessionIfNeeded()) { goto k9wku; } goto Pr208; Rs17X: session_write_close(); goto OzNr1; yOyGz: J3cuV: goto IvKlK; Pr208: if (!isset($_COOKIE["\141\144\x76\x5f\164\157\153\145\156"])) { goto pnx2l; } goto KcI2Q; IvKlK: pnx2l: goto cwHk6; cRh2Y: k9wku: goto v5qy5; jLS1r: return true; goto utBi3; bR7Sr: session_unset(); goto XLkYG; uaTud: unset($_SESSION["\x75\x73\145\x72"]); goto TUylH; cwskU: if (!(session_status() === PHP_SESSION_ACTIVE)) { goto AO7_b; } goto bR7Sr; v5qy5: $this->isLoggedIn = false; goto leEic; cwHk6: if (!isset($_SESSION["\x75\163\x65\x72"])) { goto KtHGO; } goto uaTud; TUylH: KtHGO: goto cwskU; utBi3: } public function redirection() { goto vEmUX; Te8Dp: if ($this->isLoggedIn) { goto EYbek; } goto I4Tpm; vEmUX: session_write_close(); goto Te8Dp; I4Tpm: redirectTo(BACKEND_BASEURL . "\x6c\157\147\151\x6e\57"); goto ZwFKi; ZwFKi: EYbek: goto lTWvO; lTWvO: } }
