<?php
/*   __________________________________________________
    |  Obfuscated by YAK Pro - Php Obfuscator  2.0.16  |
    |              on 2025-05-18 20:27:33              |
    |    GitHub: https://github.com/pk-fr/yakpro-po    |
    |__________________________________________________|
*/
/*
Copyright @ 2020 - 2025 GDPlayer v4.7.1. https://gdplayer.to | https://t.me/gdplayerto
*/
 namespace GDPlayer\Ajax; use GDPlayer\{Config, Core, GoogleDriveRestAPI, Helper, Hosting, InstanceCache, Subscene, Update, UUID}; use GDPlayer\Model\{GDriveAuth, LoadBalancer, Stat, StatUA, Subtitle, SubtitleManager, User, Video, VideoAlternative, VideoSource}; class PublicAjax extends \GDPlayer\Ajax { protected LoadBalancer $balancer; protected Core $core; protected GoogleDriveRestAPI $gdAPINew; protected GDriveAuth $gdAuth; protected Hosting $hosting; protected Stat $stats; protected StatUA $statsUA; protected Subtitle $sub; protected SubtitleManager $subMan; protected Subscene $subscene; protected Update $update; protected User $users; protected UUID $uuid; protected VideoAlternative $vAlt; protected Video $videos; protected VideoSource $vSources; protected const MESSAGE_USERNAME_EXIST = "\124\150\145\40\165\163\145\x72\x6e\x61\155\145\x20\x69\163\x20\x61\154\162\x65\141\144\x79\x20\x72\145\x67\x69\x73\164\x65\162\145\144"; protected const MESSAGE_EMAIL_EXIST = "\x54\x68\x65\x20\145\x6d\141\151\154\x20\141\144\x64\162\145\x73\163\40\x69\x73\40\x61\x6c\x72\145\141\x64\x79\x20\x72\145\x67\x69\x73\x74\145\162\145\144"; protected const MESSAGE_STAT_SUCCESS = "\124\157\164\141\x6c\40\144\141\x69\x6c\171\40\x76\x69\163\151\164\x73\40\x73\165\x63\143\145\x73\163\146\x75\154\154\171\40\x61\144\144\x65\x64"; protected const MESSAGE_STAT_FAIL = "\124\157\164\141\154\40\144\x61\151\x6c\171\40\x76\151\163\151\x74\x73\40\x68\x61\x76\x65\x20\142\x65\145\x6e\x20\145\170\x63\x65\x65\144\x65\144"; protected const MESSAGE_CACHE_CLEAR_SUCCESS = "\124\150\x65\40\x76\x69\144\145\157\x20\143\141\x63\x68\145\x20\x63\x6c\145\x61\x72\x65\x64\x20\x73\x75\143\143\145\x73\x73\x66\x75\154\154\171"; protected const MESSAGE_CACHE_CLEAR_FAIL = "\x46\141\x69\x6c\145\144\x20\164\x6f\40\143\154\x65\141\x72\40\x74\x68\145\40\x63\x61\143\x68\x65\40\157\146\40\x74\150\x65\40\166\151\x64\145\x6f\x20\157\x72\40\x74\150\x65\x20\x76\x69\144\145\x6f\x20\144\x6f\x65\x73\40\x6e\x6f\x74\40\145\x78\x69\x73\x74"; protected const MESSAGE_CREATE_PLAYER_FAIL = "\111\156\x73\x65\x72\164\40\x74\x68\x65\40\166\x69\144\145\157\40\x55\x52\114\40\x66\151\x72\163\164"; protected const MESSAGE_FEATURE_DISABLE = "\x54\x68\151\x73\40\146\x65\141\x74\165\162\x65\40\151\x73\40\144\x69\163\141\x62\154\145\x64"; protected const MESSAGE_GDRIVE_GET_TOKEN_FAIL = "\x55\156\x61\142\x6c\x65\x20\x74\x6f\x20\162\x65\164\162\151\x65\166\145\40\x61\x63\143\145\163\163\x20\164\157\153\145\x6e"; protected const MESSAGE_GDRIVE_BYPASS_FAIL = "\x43\x61\x6e\156\x6f\164\40\x62\171\x70\141\x73\x73\x20\164\150\x65\x20\146\x69\x6c\145\54\x20\x74\x72\171\x20\x6c\x61\164\145\162"; protected const MESSAGE_VIDEO_SAVE_SUCCESS = "\x54\150\145\x20\x6e\145\x77\x20\166\151\144\145\x6f\x20\x68\x61\163\40\x62\x65\x65\156\40\163\x61\166\x65\x64\x20\x73\x75\143\143\145\163\x73\x66\165\x6c\154\x79"; protected const MESSAGE_VIDEO_SAVE_FAIL = "\x54\x68\145\40\156\x65\167\40\x76\x69\x64\145\x6f\40\146\141\x69\154\x65\x64\x20\164\157\40\x73\x61\x76\x65"; private $downloadSlug = "\144"; private $embedSlug = "\x65"; private $embed2Slug = "\162"; public function __construct() { goto kgrFY; z7FZ_: $this->sub = Subtitle::getInstance(); goto JqAZN; TQdCH: $this->data = array_merge($_POST, $_GET); goto BRQNc; VzVCk: $this->downloadSlug = Config::get("\x73\154\165\147\137\x64\157\x77\x6e\154\157\141\x64") ?? "\x64"; goto GSABx; BRQNc: $this->files = $_FILES; goto PHkcs; sXlQd: $this->vAlt = VideoAlternative::getInstance(); goto l44mM; N6A3T: $this->embed2Slug = Config::get("\x73\154\x75\x67\137\162\x65\x71\x75\x65\163\x74") ?? "\x64"; goto MgevW; GSABx: $this->embedSlug = Config::get("\x73\x6c\165\x67\137\145\x6d\x62\x65\x64") ?? "\x65"; goto N6A3T; Gt2fh: $this->core = new Core(); goto SJCXX; kgrFY: session_write_close(); goto TQdCH; ceUPV: $this->subscene = new Subscene(); goto oCEUi; ii31R: $this->users = User::getInstance(); goto RAAf4; SJCXX: $this->gdAPINew = new GoogleDriveRestAPI(); goto slWsm; q0fV_: $this->uuid = new UUID(); goto RIafb; V1BAx: $this->statsUA = StatUA::getInstance(); goto z7FZ_; RAAf4: $this->videos = Video::getInstance(); goto sXlQd; slWsm: $this->hosting = new Hosting(); goto ceUPV; l44mM: $this->vSources = VideoSource::getInstance(); goto VzVCk; RIafb: $this->gdAuth = GDriveAuth::getInstance(); goto BFw6t; BFw6t: $this->balancer = LoadBalancer::getInstance(); goto mYa9G; oCEUi: $this->update = new Update(); goto q0fV_; JqAZN: $this->subMan = SubtitleManager::getInstance(); goto ii31R; mYa9G: $this->stats = Stat::getInstance(); goto V1BAx; PHkcs: $this->loadData(); goto Gt2fh; MgevW: } protected function publicValidation() { goto HgptQ; DXtij: $valid2 = in_array($action, $unAuth); goto EiC74; eti3z: $this->currentUser = currentUser($this->data["\164\x6f\x6b\x65\156"] ?? ''); goto TyOkk; OIZPQ: HWiGt: goto qIQBO; atdIa: $recaptchaAuth = ["\143\162\x65\141\x74\x65\x50\x6c\141\x79\x65\x72", "\147\x64\x72\151\166\145\102\171\x70\141\x73\x73\114\151\x6d\151\164"]; goto nyZyH; GxOXj: if (empty($token)) { goto xH9Sf; } goto nsPtv; fm1Hv: MQQlk: goto b3c4a; nsPtv: if (strpos($token, "\x2d\54") !== false) { goto HWiGt; } goto eti3z; akpZ3: $allowed = loginTokenValidation($ex[0]) || corsPolicyValidation($ex[0]); goto fm1Hv; N0pQ5: $action = $this->data["\x61\x63\x74\151\x6f\x6e"] ?? ''; goto nSStb; HgptQ: session_write_close(); goto N0pQ5; oJ44a: $valid1 = $allowed; goto DXtij; zIv6F: goto MQQlk; goto OIZPQ; qIQBO: $ex = array_pad(explode("\55\x2c", $this->data["\x74\157\153\x65\156"]), 2, ''); goto akpZ3; QpAJQ: $recaptchaValidation = recaptchaValidation($this->data["\x67\55\162\145\x63\141\x70\164\x63\x68\x61\55\x72\145\x73\160\x6f\156\163\x65"] ?? ''); goto GxOXj; EiC74: $valid3 = in_array($action, $recaptchaAuth) && $recaptchaValidation; goto bCAo9; bCAo9: return $valid1 || $valid2 || $valid3; goto io7SQ; nSStb: $unAuth = ["\143\x68\145\143\x6b\x45\x6d\141\151\x6c", "\143\x68\x65\x63\153\125\x73\145\x72\156\x61\155\x65", "\x73\x79\163\164\x65\x6d\x43\150\145\x63\153\x65\162"]; goto atdIa; nyZyH: $allowed = false; goto k_lyu; TyOkk: $allowed = loginTokenValidation($token) || corsPolicyValidation($token) || $this->currentUser; goto zIv6F; k_lyu: $token = $this->getToken(); goto QpAJQ; b3c4a: xH9Sf: goto oJ44a; io7SQ: } public function response() { goto Qpylc; dGGxU: ljeFk: goto Tq7Od; lTJVN: $result = $this->notAuthorize(); goto pXpEL; BU3pk: $result = $this->loadAction($this); goto dGGxU; Tq7Od: return $this->createJsonResponse($result); goto il9m0; Qpylc: session_write_close(); goto EMKuc; pXpEL: goto ljeFk; goto WP8jd; EMKuc: if ($this->publicValidation()) { goto G3GXY; } goto lTJVN; WP8jd: G3GXY: goto BU3pk; il9m0: } protected function saveBulkHelper(int $vid = 0, array $dataVideo = []) { goto Npr09; u71wo: $time = time(); goto ccVeu; Fn9Pq: $slug = createSlug(); goto X3DJs; pRr0s: $subCount = 0; goto PjTaE; YwPnB: $this->videos->setCriteria("\151\x64", $vid); goto CFM11; Fd0Kt: y2WmG: goto MlHIw; AHjC1: zbd2Q: goto bFnbr; mviJ4: $this->videos->setCriteria("\151\x64", $vid); goto daSXA; wUra2: return ["\141\143\164\x69\x6f\x6e\163" => ["\145\x6d\x62\x65\144" => $embed, "\144\x6f\167\156\154\157\x61\x64" => Config::get("\x6d\141\x69\156\x5f\163\151\164\x65") . $this->downloadSlug . SLASH . $slug, "\x65\155\x62\145\144\137\143\157\x64\x65" => sanitizeHtml(sprintf($iframe, $embed))], "\163\165\142\137\x63\157\x75\x6e\164" => $subCount, "\x73\154\x75\x67" => $slug]; goto ZYW99; PjTaE: if (validateBoolean($this->data["\165\x73\x65\124\x69\164\154\x65"] ?? 0) && !empty($dataVideo["\164\151\x74\x6c\x65"])) { goto y2WmG; } goto Fn9Pq; X3DJs: goto fhh1s; goto Fd0Kt; ccVeu: foreach ($dataVideo["\164\162\141\x63\153\163"] as $tr) { goto R1QoV; jvwA9: IQn_7: goto anCYw; Y8rFW: AOkhg: goto sZe3X; NYgSv: if (!(intval($sid) > 0)) { goto AOkhg; } goto b8Tu1; b8Tu1: $subCount++; goto Y8rFW; DMXhP: $sid = $this->sub->insert(["\154\x69\156\153" => $tr["\146\151\x6c\x65"], "\154\x61\x6e\x67\x75\x61\147\x65" => $tr["\x6c\x61\x62\145\x6c"], "\x76\151\x64" => $vid, "\x61\x64\144\145\x64" => $time, "\x75\x70\144\x61\x74\x65\144" => $time, "\x75\x69\x64" => $this->currentUser["\x69\x64"]]); goto NYgSv; sZe3X: vSb1i: goto jvwA9; R1QoV: if (!validateUrl($tr["\146\x69\x6c\x65"])) { goto vSb1i; } goto DMXhP; anCYw: } goto Mtf3T; L_Gzr: XexAk: goto lTtfc; bFnbr: if (empty($dataVideo["\164\162\x61\143\x6b\x73"])) { goto XexAk; } goto u71wo; CFM11: $this->videos->update(["\x73\154\165\x67" => $slug]); goto AHjC1; Zz4kb: fhh1s: goto mviJ4; daSXA: $updateSlug = $this->videos->update(["\163\154\165\147" => $slug]); goto iBBbY; lTtfc: $iframe = strtr(Config::get("\151\146\162\141\x6d\x65\137\x63\157\144\145") ?? "\x3c\151\146\162\141\x6d\145\x20\146\162\x61\x6d\x65\142\157\x72\x64\x65\162\75\42\60\42\x20\167\151\x64\164\x68\x3d\x22\x36\64\x30\42\40\x68\145\x69\147\150\x74\75\42\x33\62\60\42\40\163\x72\x63\x3d\x22\x25\x73\42\40\141\x6c\154\157\x77\x66\x75\x6c\x6c\163\143\162\145\145\156\x3e\74\57\151\146\162\x61\x6d\145\76", ["\x7b\x65\155\x62\145\144\x5f\x75\x72\154\175" => "\45\163"]); goto kmdWV; Mtf3T: Wv2pJ: goto L_Gzr; iBBbY: if ($updateSlug) { goto zbd2Q; } goto MCHkK; Npr09: session_write_close(); goto pRr0s; MCHkK: $slug = $this->uuid->v4(); goto YwPnB; MlHIw: $slug = slugify($dataVideo["\x74\x69\164\154\145"]); goto Zz4kb; kmdWV: $embed = Config::get("\x6d\141\x69\x6e\137\163\x69\164\x65") . $this->embedSlug . SLASH . $slug; goto wUra2; ZYW99: } protected function saveBulkProcess() { goto to4Eh; KLM0E: $dataResult = array_replace($dataResult, $this->saveBulkHelper($vid, $dataVideo)); goto KFASg; UaolA: $host = $this->hosting->getHost(); goto ixU3L; jD58h: return $this->toJson(0, self::MESSAGE_VIDEO_SAVE_FAIL, ["\x64\x61\x74\141" => $dataResult, "\x6f\x66\x66\x73\x65\x74" => $offset, "\x6e\145\x78\x74" => $offset + 1, "\164\157\x74\x61\154" => $total]); goto xMNLS; nFsRX: $dataResult["\150\157\163\164\137\151\144"] = $id; goto UCjHb; YYry5: $vid = $this->videos->insert(["\x74\x69\164\x6c\145" => $dataVideo["\x74\x69\x74\154\x65"], "\x68\157\x73\164" => $host, "\x68\x6f\163\x74\x5f\151\144" => $id, "\165\x69\x64" => $this->currentUser["\x69\144"], "\x70\x6f\x73\164\x65\162" => $dataVideo["\x69\155\x61\x67\x65"], "\x61\x64\x64\145\x64" => $time, "\x75\x70\x64\x61\164\145\x64" => $time]); goto BAn_U; xa0hr: $total = intval($this->data["\164\157\164\x61\x6c"] ?? 0); goto x8Wxv; BAn_U: if (!(intval($vid) > 0)) { goto GwlBV; } goto qFQVb; x8Wxv: $time = time(); goto QiK92; qpz7J: $offset = intval($this->data["\157\x66\146\163\x65\164"] ?? 0); goto xa0hr; ILU43: $dataResult["\150\157\x73\x74"] = $host; goto nFsRX; K3u96: $dataResult["\x6c\x69\156\x6b"] = $this->data["\x64\x61\x74\141"]; goto Uj0rf; bPw6v: $dataResult["\164\151\164\x6c\145"] = $dataVideo["\164\x69\164\154\145"]; goto YYry5; ixU3L: $id = $this->hosting->getID(); goto hyOBY; Uj0rf: $this->hosting->setURL($this->data["\144\141\164\141"]); goto UaolA; hAeR9: $dataResult["\x70\x6f\163\x74\x65\x72"] = $dataVideo["\x69\155\x61\147\x65"]; goto bPw6v; n_Ops: KWm4H: goto FS278; KFASg: return $this->toJson(1, self::MESSAGE_VIDEO_SAVE_SUCCESS, ["\x64\141\164\x61" => $dataResult, "\157\146\x66\x73\x65\x74" => $offset, "\x6e\x65\x78\164" => $offset + 1, "\x74\x6f\x74\141\x6c" => $total]); goto Ljcc4; FS278: W6XGq: goto jD58h; to4Eh: session_write_close(); goto qpz7J; X6IoZ: $dataResult["\x69\144"] = $vid; goto KLM0E; hyOBY: $this->core->setQuery(["\x68\x6f\x73\x74" => $host, "\151\x64" => $id]); goto RmMx2; QiK92: $dataResult = ["\x69\144" => 0, "\x73\165\142\x5f\x63\157\165\x6e\164" => 0, "\141\x6c\x74\137\x63\157\165\x6e\x74" => 0, "\164\151\x74\x6c\145" => '', "\x69\x6d\x61\147\145" => '', "\x70\x6f\x73\x74\x65\x72" => '', "\x61\144\x64\145\x64" => $time, "\x73\x74\x61\164\165\163" => 1, "\x61\x63\164\x69\x6f\x6e\163" => [], "\163\x6c\165\x67" => '']; goto mWol2; qFQVb: $dataResult["\163\164\x61\164\165\x73"] = 0; goto X6IoZ; mWol2: if (!($this->currentUser && !empty($this->data["\144\141\164\x61"]) && validateUrl($this->data["\144\x61\x74\x61"]) && !empty($total))) { goto W6XGq; } goto K3u96; UCjHb: if (empty($dataVideo["\163\157\165\162\x63\145\x73"])) { goto KWm4H; } goto hAeR9; RmMx2: $dataVideo = $this->core->getResult(); goto ILU43; Ljcc4: GwlBV: goto n_Ops; xMNLS: } protected function updateNow() { goto xRfKu; GMw_v: $processNum = $cache->isHit() ? intval($cache->get()) : 0; goto Hyp4H; mAiQg: $cache = InstanceCache::getItem("\x75\160\144\141\x74\x65\137\160\162\x6f\143\145\x73\x73\55\156\165\x6d"); goto GMw_v; NZ0pe: return $this->toJson(1); goto bpm6n; yEtNd: $num = $processNum + 1; goto tjYO9; zRmDS: $processTotal = $cache->isHit() ? intval($cache->get()) : 0; goto mAiQg; Hyp4H: if (!($processNum <= $processTotal)) { goto JZjMp; } goto yEtNd; MXtbE: JZjMp: goto NZ0pe; tjYO9: $this->update->updateNow($num); goto MXtbE; xRfKu: session_write_close(); goto Qn3pa; Qn3pa: $cache = InstanceCache::getItem("\165\160\144\141\164\x65\x5f\160\162\x6f\x63\x65\x73\163\x2d\x74\157\x74\x61\x6c"); goto zRmDS; bpm6n: } protected function updateChecker() { goto XAEjM; GKmEt: $processTotal = $cache->isHit() ? intval($cache->get()) : 0; goto vXgMl; EDFFT: if (!($processNum <= $processTotal)) { goto J8oco; } goto LBmr7; wB6D3: $this->update->updateNow($num); goto FxIDN; ol4xW: return $this->toJson(1, '', ["\164\x6f\164\141\x6c" => $processTotal, "\156\165\155\142\145\162" => $processNum]); goto FPbmb; XAEjM: session_write_close(); goto moQSE; moQSE: $cache = InstanceCache::getItem("\x75\x70\x64\141\x74\145\137\160\162\x6f\143\x65\x73\163\55\164\157\164\x61\154"); goto GKmEt; vXgMl: $cache = InstanceCache::getItem("\x75\x70\x64\x61\x74\145\x5f\160\162\157\143\x65\163\x73\55\x6e\165\x6d"); goto vKmnt; FxIDN: J8oco: goto ol4xW; vKmnt: $processNum = $cache->isHit() ? intval($cache->get()) : 0; goto EDFFT; LBmr7: $num = $processNum + 1; goto wB6D3; FPbmb: } protected function gdriveBypassLimit() { goto JdpWZ; PIMjM: return $result; goto a0vdw; vOVF1: goto oRDQw; goto MYuu9; stbSE: $result = $this->toJson(1, '', array("\x6c\151\x6e\x6b" => "\150\x74\164\x70\163\72\x2f\57\144\x72\x69\x76\x65\56\x67\x6f\157\147\154\x65\56\x63\157\x6d\57\x66\x69\x6c\145\57\x64\57" . $file["\151\144"] . "\x2f\166\151\x65\x77", "\x69\x64" => $file["\x69\144"])); goto K5TUD; x2nZb: $list = $this->gdAuth->get(["\x65\155\141\x69\154"]); goto Ojhe7; MYuu9: ICNJj: goto stbSE; dqfec: foreach ($list as $dt) { goto lqYi3; Y1zu1: goto hEUjX; goto zqMFN; lqYi3: $this->gdAPINew->setEmail($dt["\x65\x6d\141\x69\154"]); goto qayIU; zqMFN: YXigY: goto ICUba; qayIU: $this->gdAPINew->setFileID($this->data["\x67\x64\x72\x69\x76\x65\137\151\x64"]); goto Pg1mJ; ysAeI: if (!$file) { goto YXigY; } goto Y1zu1; Pg1mJ: $file = $this->gdAPINew->copy(); goto ysAeI; ICUba: kN398: goto YKxtc; YKxtc: } goto wwGzi; octFZ: if (!validateBoolean(Config::get("\145\x6e\x61\142\154\x65\x5f\147\x73\150\x61\x72\145\162"))) { goto oySDL; } goto HQvH_; w3qHN: if (!empty($file["\x69\x64"])) { goto ICNJj; } goto Vpukv; Ojhe7: if (!$list) { goto Dv6Iw; } goto dqfec; K5TUD: oRDQw: goto AA83j; Vpukv: $result = $this->toJson(0, self::MESSAGE_GDRIVE_BYPASS_FAIL); goto vOVF1; JdpWZ: session_write_close(); goto octFZ; wwGzi: hEUjX: goto qdIZN; AA83j: goto xQEbw; goto z6bY2; z6bY2: oySDL: goto Vtq81; EtlVf: $this->gdAuth->setCriteria("\x73\164\x61\164\x75\x73", 1); goto x2nZb; Vtq81: $result = $this->toJson(0, self::MESSAGE_FEATURE_DISABLE); goto nzFlX; nzFlX: xQEbw: goto PIMjM; qdIZN: Dv6Iw: goto w3qHN; HQvH_: $file = false; goto EtlVf; a0vdw: } protected function createPlayer() { goto ggrbX; PqtQj: wFOZL: goto AJF4N; SM4XV: umfCy: goto xijsS; EojaO: if (!empty($this->files["\x70\157\163\x74\145\162\x2d\146\151\x6c\145"]["\x74\155\x70\x5f\156\141\155\145"][0])) { goto Mngs4; } goto rBx33; WApUb: $uploadSubtitles = $this->subMan->uploadMultipleSubtitlesFiles2(); goto KiI_A; CMsCa: $posterFile = uploadPoster($this->files["\x70\x6f\163\164\145\162\55\146\151\154\145"]); goto TKGsH; N962L: Mngs4: goto CMsCa; z49sV: $qry["\x73\x75\x62\163"] = $this->data["\163\165\x62\x73"]; goto PqtQj; eRQg8: $qry["\165\151\x64"] = publicUserLogin(); goto jpEv4; bgeU5: goto NKvzP; goto fmHYp; xijsS: $subtitlesUrls = []; goto uwbvd; AJF4N: $qry["\160\x6f\x73\x74\145\162"] = ''; goto EojaO; lFXfP: $subtitlesFiles = []; goto A7rhS; KiMQ2: $subtitlesUrls = array_column($saveSubtitles, "\x66\x69\x6c\x65"); goto wCfFo; SsISF: $qry["\x69\x64"] = $this->hosting->getID(); goto nWA2n; TKGsH: if (!$posterFile) { goto hdVy9; } goto GEo0L; BLYLB: $this->hosting->setURL($this->data["\141\151\144"]); goto kEFpV; uwbvd: $subtitlesLabelsUrls = []; goto C_cC5; Hk1cO: $qry["\x70\157\163\x74\145\x72"] = sanitizeUrl($this->data["\x70\x6f\x73\x74\145\x72"]); goto tEgcr; tEgcr: NKvzP: goto eRQg8; qJ73l: $qry["\150\157\163\x74"] = $this->hosting->getHost(); goto SsISF; EUamj: if (empty($saveSubtitles)) { goto jX26w; } goto KiMQ2; U_uXS: EywmR: goto Blm3Q; w8Kky: $subtitlesFiles = array_column($uploadSubtitles, "\x66\x69\154\145"); goto wtS63; ggrbX: session_write_close(); goto Hxy8_; wtS63: $subtitlesLabelsFiles = array_column($uploadSubtitles, "\x6c\x61\142\145\x6c"); goto FjFmg; fmHYp: sQbZ5: goto Hk1cO; Hxy8_: if (!empty($this->data["\x69\x64"])) { goto EywmR; } goto a2vtT; wPDHq: $qry["\x6c\141\156\147"] = array_merge($subtitlesLabelsFiles, $subtitlesLabelsUrls); goto TjBld; rBx33: if (!empty($this->data["\160\x6f\163\x74\145\x72"])) { goto sQbZ5; } goto Xu6WX; TjBld: if (!(isset($this->data["\163\x75\x62\x73"]) && validateUrl($this->data["\163\x75\142\163"]))) { goto wFOZL; } goto z49sV; MFxWN: $this->hosting->setURL($this->data["\x69\x64"]); goto qJ73l; Xu6WX: goto NKvzP; goto N962L; uC0NK: $qry["\163\x75\142"] = array_merge($subtitlesFiles, $subtitlesUrls); goto wPDHq; FjFmg: xzyzX: goto uC0NK; nWA2n: if (empty($this->data["\x61\x69\x64"])) { goto umfCy; } goto BLYLB; jpEv4: $qs = buildQueryNoIndex($qry); goto ji5wr; C_cC5: $saveSubtitles = $this->subMan->saveMultipleSubtitlesUrls2(); goto EUamj; iaqmQ: $embedURL = BASE_URL . $this->embedSlug . "\57\x3f" . $qryEncoded; goto DOa2P; KiI_A: if (empty($uploadSubtitles)) { goto xzyzX; } goto w8Kky; A7rhS: $subtitlesLabelsFiles = []; goto WApUb; fh2t8: jX26w: goto lFXfP; JIlaW: hdVy9: goto bgeU5; ji5wr: $qryEncoded = $this->security->encryptURL($qs); goto iaqmQ; a2vtT: return $this->toJson(1, self::MESSAGE_CREATE_PLAYER_FAIL); goto U_uXS; kEFpV: $qry["\x61\x68\157\163\164"] = $this->hosting->getHost(); goto osP3x; Blm3Q: $qry = []; goto MFxWN; wCfFo: $subtitlesLabelsUrls = array_column($saveSubtitles, "\x6c\141\x62\145\x6c"); goto fh2t8; osP3x: $qry["\x61\x69\144"] = rawurldecode($this->hosting->getID()); goto SM4XV; DOa2P: return $this->toJson(1, '', array("\145\155\x62\145\144\x5f\165\x72\x6c" => $embedURL, "\144\x6f\x77\x6e\x6c\157\x61\x64\x5f\165\x72\x6c" => BASE_URL . $this->downloadSlug . "\x2f\x3f" . $qryEncoded, "\x72\x65\x71\x75\145\163\164\x5f\x75\x72\x6c" => BASE_URL . $this->embed2Slug . "\x2f\77" . $qs, "\145\155\x62\145\x64\137\143\x6f\144\x65" => createIframe($embedURL))); goto VCLpC; GEo0L: $qry["\x70\x6f\163\164\x65\x72"] = basename($posterFile); goto JIlaW; VCLpC: } protected function clearVideoCache() { goto jlmCq; lxLEc: $qry = Helper::decryptData($this->data["\144\x61\164\x61"]); goto AyKpI; deeiX: $lang = $_SERVER["\x48\x54\x54\x50\137\101\103\x43\x45\120\x54\x5f\114\101\116\x47\125\x41\x47\105"] ?? ACCEPT_LANGUAGE; goto G8r5l; Z0BGL: $this->videos->setCriteria("\151\144", $qry["\x69\144"]); goto Z0jdn; H2uf4: vlrXR: goto P8rdI; N0uge: if (validateUrl($qry["\x69\144"])) { goto zVGB1; } goto EjHPb; Z0jdn: $videoList[] = $this->videos->getOne(["\x68\x6f\x73\x74", "\150\157\x73\x74\137\x69\144"]); goto H2uf4; hUzSP: qJip_: goto xndId; j7Mat: if (empty($videoList)) { goto tGn5N; } goto AJM2R; G8r5l: $ip = getUserIP(); goto WqBwE; WqBwE: foreach ($videoList as $dt) { goto revMw; E0EpD: hLX2f: goto hcS41; revMw: $this->vSources->setCriteria("\150\x6f\x73\164", $dt["\x68\157\163\x74"]); goto pegaq; r6m2b: eSddp: goto D1hem; DAWN7: $this->vSources->setCriteria("\x75\141", $ua, "\75", "\x41\116\104"); goto YNlnE; w9Oh6: $this->vSources->setCriteria("\x69\x70", $ip, "\75", "\x41\x4e\104"); goto r6m2b; D1hem: $cleared["\143\154\145\141\162\x5f\166\151\x64\x65\x6f\137\163\157\x75\162\143\x65\x73"][] = $this->vSources->delete(); goto E0EpD; pegaq: $this->vSources->setCriteria("\150\x6f\163\164\x5f\151\x64", $dt["\150\x6f\163\x74\x5f\x69\x64"], "\x3d", "\x41\x4e\x44"); goto TYQfu; TYQfu: if (!in_array($dt["\150\157\x73\164"], directHosts())) { goto eSddp; } goto DAWN7; YNlnE: $this->vSources->setCriteria("\154\141\x6e\147", $lang, "\75", "\101\x4e\x44"); goto w9Oh6; hcS41: } goto Ku3MJ; rI1s5: return $this->toJson(1, self::MESSAGE_CACHE_CLEAR_SUCCESS, $cleared); goto PN6T8; jrwcy: $this->vAlt->setCriteria("\151\x64", $qry["\141\154\164"]); goto nxqp_; P8rdI: if (!(!empty($qry["\x68\x6f\x73\x74"]) && !empty($qry["\151\144"]))) { goto kBsLk; } goto N0uge; PYe11: $this->hosting->setURL($qry["\x69\144"]); goto LCjXr; Ku3MJ: rD8C9: goto j2mBs; AyKpI: $alt = isset($qry["\x61\x6c\x74"]) ? intval($qry["\x61\x6c\164"]) : -1; goto QznVj; j2mBs: tGn5N: goto Y6xt6; sTk1J: if (!empty($this->data["\144\x61\x74\141"])) { goto Youqw; } goto javux; Y6xt6: $cleared["\143\154\145\141\162\137\x76\151\x64\x65\157\137\x73\157\x75\x72\143\145\x73"][] = $this->vSources->clearCache(); goto Ha7FD; javux: return $this->toJson(0, self::MESSAGE_CACHE_CLEAR_FAIL, []); goto mhGly; QznVj: if (!($alt > 0)) { goto cSDf8; } goto jrwcy; ZeKrG: cSDf8: goto pyK6Q; pyK6Q: if (empty($qry["\163\157\165\162\143\x65"])) { goto vlrXR; } goto Z0BGL; Rgq2u: $cleared = []; goto j7Mat; nxqp_: $videoList[] = $this->vAlt->getOne(["\150\x6f\x73\164", "\150\x6f\x73\164\x5f\151\144"]); goto ZeKrG; mhGly: Youqw: goto dYyM1; dYyM1: $videoList = []; goto lxLEc; LCjXr: $videoList[] = ["\x68\157\163\164" => $this->hosting->getHost(), "\x68\x6f\x73\164\x5f\x69\144" => $this->hosting->getID()]; goto hUzSP; vmf2r: goto qJip_; goto jroyk; xndId: kBsLk: goto Rgq2u; AJM2R: $ua = $_SERVER["\110\x54\124\x50\137\125\x53\x45\122\x5f\x41\x47\x45\116\124"] ?? USER_AGENT; goto deeiX; jlmCq: session_write_close(); goto sTk1J; Ha7FD: $cleared["\143\154\x65\141\162\x5f\166\x69\x64\145\157\137\160\154\x61\171\145\162"] = InstanceCache::deleteItemsByTags([OPTIONS_TAG, PLAYER_CONFIG_TAG, "\x66\151\154\x65\x73\x69\172\x65"]); goto rI1s5; jroyk: zVGB1: goto PYe11; EjHPb: $videoList[] = ["\150\x6f\163\164" => $qry["\150\157\163\164"], "\150\157\163\164\137\x69\x64" => $qry["\151\x64"]]; goto vmf2r; PN6T8: } protected function saveStat(int $videoId = 0, int $currentViews = 0) { goto NlGVM; NlGVM: session_write_close(); goto LATqu; pxxD7: $getUA = $this->statsUA->getOne(["\151\x64"]); goto kuIry; tD9Fv: $this->videos->update(array("\166\x69\145\167\x73" => $currentViews)); goto MFqQu; RAqBX: if (!($max <= 0)) { goto OMB5t; } goto iptAA; BAQbs: return false; goto GjRPA; e7ZO5: $num = $this->stats->getNumRows(); goto Q6Gmw; r173D: $uaId = intval($this->statsUA->insert(["\165\x61" => $ua])); goto NkbPu; NkbPu: goto pgz9M; goto mJfn9; MFqQu: return $this->stats->insert(array("\x76\x69\x64" => $videoId, "\151\160" => $ip, "\165\141" => $uaId, "\143\162\x65\141\x74\145\x64" => $time)); goto lJO3M; mJfn9: tcIlO: goto cLk6D; iptAA: $max = 1; goto TQXQg; eeYGV: $this->stats->setOrderBy("\x63\x72\x65\x61\x74\x65\144", "\104\x45\x53\x43"); goto e7ZO5; NB2el: $time = strtotime(date("\x59\55\x6d\x2d\x64")); goto idh_6; TQXQg: OMB5t: goto c3jty; rrCSz: $this->videos->setCriteria("\x69\x64", $videoId); goto tD9Fv; LATqu: $ip = getUserIP(); goto Ape5K; idh_6: $max = intval(Config::get("\x76\151\x73\x69\164\x5f\143\x6f\x75\x6e\x74\145\x72")); goto RAqBX; Ape5K: $ua = $_SERVER["\x48\124\124\120\137\x55\x53\105\122\137\101\107\105\116\x54"] ?? ''; goto NB2el; Ntgvo: pgz9M: goto Fj0w5; kuIry: if ($getUA) { goto tcIlO; } goto r173D; lJO3M: sbr4W: goto BAQbs; Fj0w5: $this->stats->setMultiCriteria([["\x69\160", $ip, "\75"], ["\166\x69\144", $videoId, "\x3d", "\x41\116\x44"], ["\143\x72\x65\x61\x74\145\144", $time, "\x3e\75", "\x41\116\x44"]]); goto eeYGV; cLk6D: $uaId = $getUA["\x69\x64"]; goto Ntgvo; c3jty: $uaId = 0; goto wjHd_; GIodd: $currentViews += 1; goto rrCSz; wjHd_: $this->statsUA->setCriteria("\165\141", $ua); goto pxxD7; Q6Gmw: if (!($num < $max)) { goto sbr4W; } goto GIodd; GjRPA: } protected function stat() { session_write_close(); return $this->statCounter(); } protected function statCounter() { goto p3fL8; z61_m: $counted = $this->saveStat(intval($videoInfo["\x69\144"]), intval($videoInfo["\x76\151\145\x77\x73"])); goto Jfru5; XLkbQ: if (!empty($qry["\x69\x64"])) { goto wO9QQ; } goto Gn1fw; mAXuf: $newQry = ["\x68\157\x73\x74" => '', "\151\x64" => '']; goto qrlx9; XD8NK: $altData = $this->vAlt->getOne(["\x76\x69\144"]); goto xeD3I; NT798: KYMua: goto uYBNK; YOLwa: $newQry["\151\x64"] = $qry["\151\x64"]; goto LUODL; UoUGO: EK8jT: goto aQ2x9; Jfru5: $result = $this->toJson(1, self::MESSAGE_STAT_SUCCESS, $counted); goto NT798; Qx9r_: $this->vAlt->setCriteria("\x76\x69\x64", $qry["\141\154\164"]); goto XD8NK; YO7FC: $result = $this->toJson(0, self::MESSAGE_STAT_FAIL, false); goto GQdBu; jYox5: goto PEWi7; goto ei82p; Uf6yC: $videoInfo = $this->videos->getOne(["\151\x64", "\x76\x69\145\167\163"]); goto jYox5; i7mN1: goto PEWi7; goto kojxJ; ei82p: yhUzx: goto yt5QW; f6PhS: if (!$videoInfo) { goto KYMua; } goto z61_m; qrlx9: if (isset($qry["\151\144"]) && validateUrl($qry["\151\x64"])) { goto srFpV; } goto XLkbQ; z0EjV: if (empty($this->data["\x64\141\164\x61"])) { goto cnNNk; } goto IuRnF; LUODL: bFrCz: goto YbGMM; O0Rl3: $this->hosting->setURL($qry["\151\144"]); goto c5MVW; rvF2z: wO9QQ: goto uttxs; yt5QW: $this->videos->setCriteria("\151\144", $qry["\151\x64"]); goto hLEXv; bpjg9: srFpV: goto O0Rl3; YbGMM: $this->videos->setMultiCriteria([["\x68\157\x73\164", $newQry["\150\x6f\163\164"], "\x3d"], ["\x68\157\x73\x74\137\x69\x64", $newQry["\151\144"], "\x3d", "\101\116\104"]]); goto Uf6yC; IN4w2: if (isset($qry["\141\154\164"]) && intval($qry["\x61\154\164"]) > 0) { goto ht5tS; } goto mAXuf; XCGiV: $videoInfo = $this->videos->getOne(["\x69\x64", "\166\151\x65\167\163"]); goto UoUGO; aQ2x9: PEWi7: goto CSPfR; Gn1fw: goto bFrCz; goto bpjg9; hLEXv: $videoInfo = $this->videos->getOne(["\151\144", "\x76\151\145\167\163"]); goto i7mN1; c5MVW: $newQry["\x68\157\x73\x74"] = $this->hosting->getHost(); goto nuRaF; POWoB: if (isset($qry["\x73\157\x75\162\x63\x65"])) { goto yhUzx; } goto IN4w2; kojxJ: ht5tS: goto Qx9r_; p3fL8: session_write_close(); goto YO7FC; qZvac: goto bFrCz; goto rvF2z; GQdBu: $videoInfo = false; goto z0EjV; uttxs: $newQry["\150\x6f\163\x74"] = $qry["\150\x6f\x73\164"]; goto YOLwa; IuRnF: $qry = Helper::decryptData($this->data["\144\x61\x74\x61"]); goto POWoB; xeD3I: if (!$altData) { goto EK8jT; } goto j9EGy; CSPfR: cnNNk: goto f6PhS; j9EGy: $this->videos->setCriteria("\151\144", $altData["\166\x69\144"]); goto XCGiV; uYBNK: return $result; goto z51yh; nuRaF: $newQry["\151\x64"] = $this->hosting->getID(); goto qZvac; z51yh: } protected function checkUsername(string $username = '') { goto ruY8j; QXZ6s: wpMlg: goto K73uy; nbsXd: $this->users->setCriteria("\151\x64", $this->currentUser["\151\x64"], "\74\x3e", "\x41\116\x44"); goto rjqC6; KMh3U: $result = $this->toJson(0, self::MESSAGE_USERNAME_EXIST); goto QXZ6s; c1RnB: $this->users->setCriteria("\165\x73\x65\x72", $username, "\x3d"); goto PTfo2; rjqC6: vBNEi: goto Th31P; Th31P: if (!($this->users->getNumRows() > 0)) { goto wpMlg; } goto KMh3U; ruY8j: session_write_close(); goto zFOCn; PTfo2: if (!$this->currentUser) { goto vBNEi; } goto nbsXd; zFOCn: $result = $this->toJson(1); goto c1RnB; K73uy: return $result; goto aePFd; aePFd: } protected function checkEmail(string $email = '') { goto OUUrd; tV3OZ: return $result; goto WoSWC; HqANw: if (!$this->currentUser) { goto rPddQ; } goto xyaRe; ZhjWU: $result = $this->toJson(0, self::MESSAGE_EMAIL_EXIST); goto AhKEy; OUUrd: session_write_close(); goto c4RlG; aOIU0: if (!($this->users->getNumRows() > 0)) { goto HvO2q; } goto ZhjWU; u6v3L: rPddQ: goto aOIU0; AhKEy: HvO2q: goto tV3OZ; c4RlG: $result = $this->toJson(1); goto kz6_e; kz6_e: $this->users->setCriteria("\x65\155\x61\151\x6c", $email, "\75"); goto HqANw; xyaRe: $this->users->setCriteria("\x69\x64", $this->currentUser["\151\144"], "\74\x3e", "\x41\116\104"); goto u6v3L; WoSWC: } protected function getLoadBalancerList() { goto C5dM6; Uj6Ts: $list = [Config::get("\155\141\x69\156\x5f\163\x69\x74\145")]; goto GP5nD; LxDZA: if (!$links) { goto EFnb0; } goto qUUtI; GP5nD: $this->balancer->setCriteria("\x73\x74\141\x74\165\x73", 1); goto rFnb2; BGzoN: EFnb0: goto b9XpT; qUUtI: $list = array_merge($list, array_column($links, "\154\151\x6e\x6b")); goto BGzoN; b9XpT: return $this->toJson(1, '', $list); goto jqQrG; rFnb2: $links = $this->balancer->get(["\x6c\151\156\x6b"]); goto LxDZA; C5dM6: session_write_close(); goto Uj6Ts; jqQrG: } }
