<?php
/*   __________________________________________________
    |  Obfuscated by YAK Pro - Php Obfuscator  2.0.16  |
    |              on 2025-05-18 20:27:34              |
    |    GitHub: https://github.com/pk-fr/yakpro-po    |
    |__________________________________________________|
*/
/*
Copyright @ 2020 - 2025 GDPlayer v4.7.1. https://gdplayer.to | https://t.me/gdplayerto
*/
 namespace GDPlayer; use GDPlayer\{InstanceCache, Views}; class FileStream { private $file = ''; private $filesize = 0; private $start = 0; private $end = 0; private $title = "\x76\x69\144\145\x6f\x2e\x6d\160\x34"; public function __construct(string $file) { goto ntkmr; PQLry: mFXRW: goto OI4vP; dy01G: if (is_readable($realPath)) { goto bCCJl; } goto HcAMS; sHRhZ: gIY2P: goto c_v_l; fz5j4: $this->end = $maxLength; goto sW2zh; IPmxZ: if (!empty($_SERVER["\x48\x54\x54\120\x5f\122\x41\x4e\107\x45"])) { goto aj_7p; } goto fz5j4; ceBS6: $this->filesize = @filesize($this->file) ?: 0; goto Ku7XQ; ztLDS: $this->end = min($this->start + MEGABYTES - 1, $this->filesize - 1); goto sHRhZ; ntkmr: session_write_close(); goto PTWrF; vIcbb: $maxLength = $this->filesize - 1; goto IPmxZ; WV5Mt: $this->filesize = intval($cache->get()); goto ehHfQ; ehHfQ: if (!($this->filesize === 0)) { goto tLfbx; } goto OdEwB; g1ReO: list($this->start, $this->end) = array_map("\151\x6e\x74\x76\141\154", array_pad(explode("\x2d", $rangeBytes), 2, 0)); goto eVNOJ; fJNaV: InstanceCache::save($cache); goto Fervx; sW2zh: goto mFXRW; goto W25Cj; dYUBG: $cache = InstanceCache::getItem("\146\151\x6c\145\x73\x69\172\145\x5f" . createHash($this->file)); goto WV5Mt; nDFJ_: exit; goto ZEM4o; c_v_l: http_response_code(206); goto PQLry; W25Cj: aj_7p: goto mxxwD; AW5ac: $this->file = $realPath; goto dYUBG; Ku7XQ: $cache->set($this->filesize)->expiresAfter(CACHE_TIMEOUT)->addTag("\x63\x61\143\x68\145\x2d\x66\151\x6c\145\x73\151\x7a\145"); goto fJNaV; HcAMS: Views::loadPage404(); goto nDFJ_; ZEM4o: bCCJl: goto AW5ac; PTWrF: $realPath = realpath($file); goto dy01G; Fervx: tLfbx: goto vIcbb; OdEwB: clearstatcache(true, $this->file); goto ceBS6; eVNOJ: if (!($this->end === 0)) { goto gIY2P; } goto ztLDS; mxxwD: $rangeBytes = strtr($_SERVER["\x48\124\x54\120\137\122\x41\116\107\x45"], ["\x62\x79\164\x65\163\x3d" => '']); goto g1ReO; OI4vP: } public function setTitle(string $title) : void { session_write_close(); $this->title = $title; } public function stream() : void { goto PuM7K; joDvt: flush(); goto LFXut; jYJwa: if (!(connection_status() !== CONNECTION_NORMAL)) { goto kUWYr; } goto LPPWG; cCw5Y: $lastModified = filemtime($this->file) ?: time(); goto GYLDl; C7xBm: openResourcesHandler(); goto vuFeR; WcX83: $contentLength = $this->end - $this->start + 1; goto fOFYU; PS4SN: V1dkZ: goto bQZ65; jC5mr: createResponseHeaders($headers, true); goto C7xBm; fBrrX: ob_flush(); goto joDvt; ag1bd: if ($fp) { goto J0uWZ; } goto JFDTw; rc9VS: fclose($fp); goto STTcZ; NfUod: $this->start += $bytesToRead; goto x_YER; f_SwM: qyJya: goto hCVz9; srG8A: J0uWZ: goto qunGJ; PuM7K: session_write_close(); goto cCw5Y; ReYVo: stream_set_chunk_size($fp, SMALL_BUFFER_SIZE); goto cEfk8; x_YER: echo fread($fp, $bytesToRead); goto fBrrX; LPPWG: goto XtRBR; goto dkRR4; JFDTw: http_response_code(500); goto p_EJ7; cEfk8: fseek($fp, $this->start); goto ROV0G; LFXut: if (!connection_aborted()) { goto V1dkZ; } goto Awn4c; hCVz9: z1DNG: goto Y2Ca9; bQZ65: goto z1DNG; goto hcRWg; fOFYU: $headers = array_merge(corsResponseHeaders(), ["\x41\x63\x63\145\x70\164\55\122\x61\x6e\147\x65\x73\72\x20\142\171\164\145\x73", "\103\x6f\156\164\145\x6e\164\55\x54\x79\x70\x65\x3a\40" . (isAppleProduct() ? getMimeType($this->file) : "\141\x70\x70\x6c\x69\143\141\164\151\x6f\x6e\x2f\157\x63\x74\x65\x74\55\163\x74\x72\x65\x61\x6d"), "\x43\157\x6e\x74\145\156\x74\55\104\151\163\x70\x6f\x73\x69\164\151\x6f\x6e\x3a\x20" . (validateBoolean($_GET["\144\x6c"] ?? false) ? "\141\x74\164\141\x63\x68\155\x65\x6e\164" : "\151\156\x6c\x69\x6e\145") . "\73\40\x66\x69\x6c\145\x6e\x61\155\145\x3d\42" . $this->title . "\x22", "\103\157\x6e\x74\x65\x6e\x74\55\114\x65\x6e\x67\x74\x68\x3a\x20" . $contentLength, "\x43\157\156\x74\x65\156\164\55\122\x61\x6e\x67\x65\72\x20\x62\171\164\x65\163\x20" . $this->start . "\55" . $this->end . "\57" . $this->filesize, "\x58\55\x43\x61\x63\150\x65\72\x20\x48\111\124", "\x45\164\x61\x67\x3a\40" . md5_file($this->file), "\x4c\x61\163\164\55\115\x6f\x64\151\x66\x69\145\144\x3a\x20" . $lastModifiedHeader]); goto jC5mr; vuFeR: $fp = @fopen($this->file, "\162\142"); goto ag1bd; qunGJ: stream_set_read_buffer($fp, BUFFER_SIZE); goto ReYVo; GYLDl: $lastModifiedHeader = gmdate("\104\54\40\144\40\115\40\131\x20\110\x3a\151\72\163", $lastModified) . "\x20\x47\115\x54"; goto WcX83; STTcZ: exit; goto a4E6P; ROV0G: set_time_limit(0); goto PIu1z; p_EJ7: exit; goto srG8A; hcRWg: XtRBR: goto rc9VS; PIu1z: if (ob_get_level()) { goto qyJya; } goto ISl_l; ISl_l: session_write_close(); goto vXw_e; Awn4c: exit; goto PS4SN; dkRR4: kUWYr: goto tCu0k; tCu0k: $bytesToRead = min(SMALL_BUFFER_SIZE, $this->end - $this->start + 1); goto NfUod; Y2Ca9: if (!(!feof($fp) && $this->start <= $this->end)) { goto XtRBR; } goto jYJwa; vXw_e: ob_start(); goto f_SwM; a4E6P: } }
