<?php
/*   __________________________________________________
    |  Obfuscated by YAK Pro - Php Obfuscator  2.0.16  |
    |              on 2025-05-18 20:27:37              |
    |    GitHub: https://github.com/pk-fr/yakpro-po    |
    |__________________________________________________|
*/
/*
Copyright @ 2020 - 2025 GDPlayer v4.7.1. https://gdplayer.to | https://t.me/gdplayerto
*/
 namespace GDPlayer; use GDPlayer\Conn; class Model extends \GDPlayer\ModelHelper { protected static ?\PDO $pdo = null; protected static $cacheTimeout = 30; private static $instance = null; private function __construct() { } private function __clone() { } public function __wakeup() { } public function initSingleton() { goto T8hdf; DQ0OL: static::$pdo = Conn::getInstance()->connect(); goto xTX2D; j6191: $this->resetVar(); goto V48C7; xTX2D: aNKXd: goto xVorc; T8hdf: if (!(static::$pdo === null)) { goto aNKXd; } goto DQ0OL; xVorc: static::$cacheTimeout = DB_CACHE_TIMEOUT; goto j6191; V48C7: } public static function getInstance() : self { goto Ix9BR; Ix9BR: if (!(self::$instance === null)) { goto ZcPRj; } goto iXPzT; I9ZOH: return self::$instance; goto O92lb; W8LVE: ZcPRj: goto I9ZOH; iXPzT: self::$instance = new self(); goto W8LVE; O92lb: } private function rawFetchQuery(string $sql, ?array $params, bool $fetchAll) : array { goto VU1ht; TGVoz: try { goto eQccJ; XMg7g: QIjhC: goto QkgQu; x3PGq: goto DltWQ; goto bJscw; i77Ry: $tags = [$tag, $tag . "\137" . $this->table]; goto wJR2I; t8woH: InstanceCache::save($cache); goto YieqP; F6ciI: if ($fetchAll) { goto uyYWN; } goto Mkw5h; Uex0K: if (!(!$cache->isExpired() && !$cache->isEmpty())) { goto QIjhC; } goto nR0WU; wJR2I: $cache->set($result)->expiresAfter(self::$cacheTimeout)->addTags($tags); goto t8woH; yiX0L: $result = $stmt->fetchAll(\PDO::FETCH_ASSOC); goto a9gOf; r0yMy: $this->cacheKey = $this->createCacheKey(strtolower(trim($ex[0]))); goto x93j7; QkgQu: $tags = []; goto kTdok; bJscw: uyYWN: goto C3QaZ; kTdok: $stmt = self::$pdo->prepare($sql); goto McWFD; C3QaZ: $tag = "\x64\x62\x2d\x72\141\167\x46\145\164\x63\150\x41\x6c\x6c"; goto yiX0L; nR0WU: $this->resetVar(); goto PXetA; m8Eeu: $this->sqlQuery = $sql; goto aJZnM; McWFD: $stmt->execute($params); goto F6ciI; eQccJ: $ex = array_pad(explode("\x20", $sql), 1, ''); goto m8Eeu; PXetA: return $cache->get(); goto XMg7g; x93j7: $cache = InstanceCache::getItem($this->cacheKey); goto Uex0K; yKGfi: $result = $stmt->fetch(\PDO::FETCH_ASSOC) ?: []; goto x3PGq; Mkw5h: $tag = "\144\142\55\x72\141\167\x46\145\x74\143\x68"; goto yKGfi; aJZnM: $this->params = $params; goto r0yMy; a9gOf: DltWQ: goto i77Ry; YieqP: } catch (\PDOException|\Exception $e) { createErrorLog([__FILE__, __FUNCTION__, $sql, $e->getMessage()]); } goto JrVms; JrVms: $this->resetVar(); goto NHObr; NHObr: return $result; goto H40F5; VU1ht: session_write_close(); goto ke4e1; ke4e1: $result = []; goto TGVoz; H40F5: } public function rawFetch(string $sql = '', ?array $params = null) { session_write_close(); return $this->rawFetchQuery($sql, $params, false); } public function rawFetchAll(string $sql = '', ?array $params = null) { session_write_close(); return $this->rawFetchQuery($sql, $params, true); } public function rawQuery(string $sql = '') { goto qgUKY; qgUKY: session_write_close(); goto tZ0We; DmrVU: return $result; goto ngKQd; tZ0We: $result = false; goto jYcmo; jYcmo: try { goto ZTrBV; C9ATv: $this->resetVar(); goto ZMwB_; RfpIx: $ex = array_pad(explode("\40", $sql), 1, ''); goto en1e9; ZjgBk: $result = self::$pdo->query($sql); goto kJmnR; pKs30: Nyi86: goto RQdju; s5SYJ: if ($prefix === "\163\x65\x6c\145\143\x74") { goto Nyi86; } goto siXPa; d5OPD: goto Vjrvj; goto pKs30; siXPa: $this->clearCache(); goto d5OPD; RQdju: $this->cacheKey = $this->createCacheKey($prefix); goto io4xh; ZMwB_: return $cache->get(); goto iv70g; chl9Y: if (!(!$cache->isExpired() && !$cache->isEmpty())) { goto A74dd; } goto C9ATv; ZTrBV: $this->sqlQuery = $sql; goto RfpIx; iv70g: A74dd: goto H06Wj; H06Wj: Vjrvj: goto ZjgBk; io4xh: $cache = InstanceCache::getItem($this->cacheKey); goto chl9Y; en1e9: $prefix = strtolower(trim($ex[0])); goto s5SYJ; kJmnR: } catch (\PDOException|\Exception $e) { createErrorLog([__FILE__, __FUNCTION__, $sql, $e->getMessage()]); } goto DmrVU; ngKQd: } public function get(array $fields = []) { goto v3bdm; afw8G: $result = false; goto pKlHl; pKlHl: try { goto qqGnL; S88mQ: $result = $cache->get(); goto tVXwp; CT7Xv: if (!$cache->isExpired() && !$cache->isEmpty()) { goto CKsHs; } goto mlh0M; vH9W_: $this->cacheKey = $this->createCacheKey(); goto cFKof; qqGnL: $fieldsQuery = $this->createQueryFields($fields); goto emEjG; mlh0M: $result = $this->rawFetchAll($this->sqlQuery, $this->params); goto t1J1t; xK_Sv: $getWhereQuery = $this->repairWhereQry(); goto w_1Ng; w_1Ng: $this->sqlQuery = "\x53\x45\114\x45\x43\124\40{$fieldsQuery}\x20" . "\106\x52\x4f\x4d\40{$this->table}\40{$this->joinQuery}\x20{$getWhereQuery}\x20" . "{$this->groupByQuery}\40{$this->orderByQuery}\40{$this->limitQuery}"; goto vH9W_; emEjG: $this->params = $this->serializeData(); goto xK_Sv; tVXwp: LWGO7: goto g5mXW; tpJEa: CKsHs: goto S88mQ; t1J1t: goto LWGO7; goto tpJEa; cFKof: $cache = InstanceCache::getItem($this->cacheKey); goto CT7Xv; g5mXW: } catch (\PDOException|\Exception $e) { createErrorLog([__FILE__, __FUNCTION__, $this->table, $e->getMessage()]); } goto BXaYS; BXaYS: $this->resetVar(); goto o7CgF; o7CgF: return $result; goto TEUmT; v3bdm: session_write_close(); goto afw8G; TEUmT: } public function getOne(array $fields = []) { goto gWAmw; hIeFZ: return $result; goto MI0Xy; NywNC: try { goto smkWC; fgo0b: $this->cacheKey = $this->createCacheKey(); goto vZZa1; fzzEy: if (!$cache->isExpired() && !$cache->isEmpty()) { goto bC0HA; } goto MOUY9; V8wop: goto kLqtB; goto bxIQD; vZZa1: $cache = InstanceCache::getItem($this->cacheKey); goto fzzEy; bxIQD: bC0HA: goto rsqPw; hzDQP: $this->params = $this->serializeData(); goto UUvz3; UUvz3: $getOneWhereQuery = $this->repairWhereQry(); goto FVxSS; rsqPw: $result = $cache->get(); goto hvfGa; MOUY9: $result = $this->rawFetch($this->sqlQuery, $this->params); goto V8wop; FVxSS: $this->sqlQuery = "\123\x45\114\105\x43\124\40{$fieldsQuery}\x20\x46\x52\x4f\115\40{$this->table}\40{$this->joinQuery}\40{$getOneWhereQuery}\40\114\x49\115\x49\x54\40\x31"; goto fgo0b; hvfGa: kLqtB: goto W6UnM; smkWC: $fieldsQuery = $this->createQueryFields($fields); goto hzDQP; W6UnM: } catch (\PDOException|\Exception $e) { createErrorLog([__FILE__, __FUNCTION__, $this->table, $e->getMessage()]); } goto mSJzo; mSJzo: $this->resetVar(); goto hIeFZ; PmapX: $result = false; goto NywNC; gWAmw: session_write_close(); goto PmapX; MI0Xy: } public function getTotalRows() { goto P6s4r; U5oSu: $this->resetVar(); goto nvVpw; P6s4r: session_write_close(); goto ktTro; BsgG2: try { goto eM2lE; OhuFw: $cache = InstanceCache::getItem($this->cacheKey); goto zoWyT; JRhx9: $this->cacheKey = $this->createCacheKey(); goto OhuFw; cyOjR: InstanceCache::save($cache); goto h8o_u; knobL: $this->sqlQuery = "\123\105\x4c\x45\103\124\40\x43\117\125\116\124\50{$primaryKey}\x29\x20\x46\x52\117\x4d\40{$this->table}\40{$this->joinQuery}\x20{$this->groupByQuery}"; goto JRhx9; h8o_u: goto m4GHr; goto ZXQ5L; vJ8KD: $stmt->execute(); goto ChDde; j_P_F: m4GHr: goto Wee6z; KNbT_: $cache->set($result)->expiresAfter(self::$cacheTimeout)->addTags(["\x64\142\55\147\145\x74\124\x6f\164\141\x6c\x52\157\x77\x73", "\x64\x62\55\147\145\x74\x54\157\164\141\154\122\x6f\x77\x73\x2d" . $this->table]); goto cyOjR; ZXQ5L: Mu9fM: goto Aibps; FujzC: $stmt = self::$pdo->prepare($this->sqlQuery); goto vJ8KD; eM2lE: $primaryKey = !empty($this->primaryKey) ? $this->primaryKey : "\52"; goto knobL; zoWyT: if (!$cache->isExpired() && !$cache->isEmpty()) { goto Mu9fM; } goto FujzC; ChDde: $result = (int) $stmt->fetchColumn(); goto KNbT_; Aibps: $result = (int) $cache->get(); goto j_P_F; Wee6z: } catch (\PDOException|\Exception $e) { createErrorLog([__FILE__, __FUNCTION__, $this->table, $e->getMessage()]); } goto U5oSu; nvVpw: return $result; goto kvqtp; ktTro: $result = 0; goto BsgG2; kvqtp: } public function getNumRows() { goto MDVLN; MDVLN: session_write_close(); goto Bc1h2; B4LnD: return $result; goto jOiQV; Bc1h2: $result = 0; goto tStFg; tStFg: try { goto WJBso; edbyd: $primaryKey = !empty($this->primaryKey) ? $this->primaryKey : "\52"; goto Vabuq; pyQic: $stmt->execute($this->params); goto WJW5w; WJW5w: $result = (int) $stmt->fetchColumn(); goto b2JqO; PLCf4: $cache = InstanceCache::getItem($this->cacheKey); goto IX38C; AQmQt: inrr0: goto JKJOh; b2JqO: $cache->set($result)->expiresAfter(self::$cacheTimeout)->addTags(["\x64\x62\x2d\x67\145\164\116\165\155\122\157\167\163", "\x64\x62\x2d\147\145\x74\x4e\x75\x6d\122\x6f\167\x73\x2d" . $this->table]); goto J_5zb; IX38C: if (!$cache->isExpired() && !$cache->isEmpty()) { goto GkADV; } goto YFSVC; kAr2b: GkADV: goto n1q37; Vabuq: $this->sqlQuery = "\x53\105\114\105\x43\124\x20\103\x4f\125\x4e\x54\x28{$primaryKey}\x29\x20\x46\x52\x4f\x4d\40{$this->table}\x20{$this->joinQuery}\x20{$getNumWhereQuery}\40{$this->groupByQuery}"; goto n1ynw; J_5zb: InstanceCache::save($cache); goto LkGpS; YFSVC: $stmt = self::$pdo->prepare($this->sqlQuery); goto pyQic; n1ynw: $this->cacheKey = $this->createCacheKey(); goto PLCf4; n1q37: $result = (int) $cache->get(); goto AQmQt; LkGpS: goto inrr0; goto kAr2b; l2ofM: $getNumWhereQuery = $this->repairWhereQry(); goto edbyd; WJBso: $this->params = $this->serializeData(); goto l2ofM; JKJOh: } catch (\PDOException|\Exception $e) { createErrorLog([__FILE__, __FUNCTION__, $this->table, $e->getMessage()]); } goto C98Ti; C98Ti: $this->resetVar(); goto B4LnD; jOiQV: } public function insert(array $input = []) { goto tjQGY; UJi_8: $result = false; goto or_Gr; Tq7wr: $this->resetVar(); goto LFLXd; or_Gr: try { goto dQCF3; LkzlC: NjxvG: goto hWBJx; AI5S6: $this->params = $this->serializeData($input); goto aA63u; WFjOM: foreach ($input as $data) { goto SGnga; SGnga: $inputKeys = array_map(fn($key) => "\72" . $key, array_keys($data)); goto C7fqR; wIyVl: i04oA: goto GtVI_; xP51D: $params = array_combine($inputKeys, $inputValues); goto r6PvR; C7fqR: $inputValues = array_map(fn($value) => is_array($value) ? json_encode($value) : $value, array_values($data)); goto xP51D; r6PvR: $stmt->execute($params); goto wIyVl; GtVI_: } goto LkzlC; dqxJh: eGv2G: goto WFjOM; gfi2e: if (array_is_list($input)) { goto eGv2G; } goto AI5S6; k6yir: $this->sqlQuery = "\111\116\123\x45\x52\x54\x20\x49\116\124\x4f\40{$this->table}\x20{$fieldsQuery}\40\126\x41\x4c\x55\105\123\40{$valuesQuery}\x20\117\x4e\40\104\x55\x50\x4c\x49\x43\x41\x54\x45\x20\113\x45\x59\40\125\120\x44\x41\124\x45\x20{$duplicateQuery}"; goto VVIhI; zcLbz: $fieldsQuery = "\50\x60" . implode("\140\x2c\x60", $keys) . "\x60\x29"; goto CEqtz; IIcuf: $result = self::$pdo->lastInsertId($this->primaryKey); goto kZRNJ; aA63u: $stmt->execute($this->params); goto O9hRY; GaVpy: lJWOn: goto WZaEl; CEqtz: $valuesQuery = "\50\72" . implode("\54\72", $keys) . "\51"; goto R3VqK; VVIhI: $stmt = self::$pdo->prepare($this->sqlQuery); goto gfi2e; F_Ljz: foreach ($keys as $key) { goto CuFy2; f3oGE: q2TiG: goto P7MFK; CuFy2: if (!($key !== $this->primaryKey)) { goto q2TiG; } goto Lxrn5; P7MFK: lxgaI: goto TG2Bh; Lxrn5: $onDuplicateKeys[] = "\x60{$key}\140\40\75\x20\x56\101\x4c\x55\x45\x53\50\140{$key}\140\x29\x2c"; goto f3oGE; TG2Bh: } goto GaVpy; kZRNJ: $this->clearCache(); goto M8lAu; R3VqK: $onDuplicateKeys = []; goto F_Ljz; WZaEl: $duplicateQuery = trim(implode('', $onDuplicateKeys), "\54"); goto k6yir; hWBJx: cguBG: goto IIcuf; dQCF3: $keys = array_is_list($input) ? array_keys($input[0]) : array_keys($input); goto zcLbz; O9hRY: goto cguBG; goto dqxJh; M8lAu: } catch (\PDOException|\Exception $e) { createErrorLog([__FILE__, __FUNCTION__, $this->table, $e->getMessage()]); } goto Tq7wr; LFLXd: return $result; goto N1qQc; tjQGY: session_write_close(); goto UJi_8; N1qQc: } public function update(array $data = []) { goto KxzRK; KxzRK: session_write_close(); goto c8Dz2; rlIaU: try { goto BgQcU; TJpXs: $this->sqlQuery = "\x55\120\x44\101\124\105\x20{$this->table}\x20\123\105\x54\x20{$fieldsQuery}\x20{$updateWhereQuery}\x20{$this->limitQuery}"; goto pMNnL; pMNnL: $stmt = self::$pdo->prepare($this->sqlQuery); goto baIUo; glKid: $this->params = $updateParams; goto HzeyZ; PJk3D: $fieldsQuery = trim($fieldsQuery, "\54\x20"); goto CibRH; aiBVb: myPqf: goto PJk3D; CibRH: $updateWhereQuery = $this->repairWhereQry(); goto TJpXs; hhouM: $fieldsQuery = ''; goto VIWbi; HzeyZ: $keys = array_keys($data); goto hhouM; BgQcU: $updateParams = $this->serializeData($data); goto glKid; baIUo: $result = $stmt->execute($updateParams); goto c_jJx; VIWbi: foreach ($keys as $key) { $fieldsQuery .= "{$key}\40\x3d\40\x3a{$key}\x2c\x20"; SY9hk: } goto aiBVb; c_jJx: $this->clearCache(); goto TSxU0; TSxU0: } catch (\PDOException|\Exception $e) { createErrorLog([__FILE__, __FUNCTION__, $this->table, $e->getMessage()]); } goto GEw1H; GEw1H: $this->resetVar(); goto z_x3V; c8Dz2: $result = false; goto rlIaU; z_x3V: return $result; goto KJ2fB; KJ2fB: } public function delete() { goto pgYkK; pgYkK: session_write_close(); goto yK_Du; avy0C: $this->resetVar(); goto d0bS1; yK_Du: $result = false; goto vOJre; vOJre: try { goto BDBqC; mCMxD: $stmt = self::$pdo->prepare($this->sqlQuery); goto pCGgC; P7VRN: $stmt = self::$pdo->query("\x41\114\124\105\122\40\124\x41\102\114\x45\40{$this->table}\40\101\x55\x54\117\x5f\111\116\x43\122\105\115\105\x4e\124\x3d\x31"); goto yI0q9; pCGgC: $result = $stmt->execute($this->params); goto P7VRN; SVG4E: $this->sqlQuery = "\x44\105\114\x45\124\x45\40\x46\x52\117\115\40{$this->table}\40{$deleteWhereQuery}"; goto mCMxD; yI0q9: $this->clearCache(); goto emvxb; BDBqC: $this->params = $this->serializeData(); goto aRiEb; aRiEb: $deleteWhereQuery = $this->repairWhereQry(); goto SVG4E; emvxb: } catch (\PDOException|\Exception $e) { createErrorLog([__FILE__, __FUNCTION__, $this->table, $e->getMessage()]); } goto avy0C; d0bS1: return $result; goto KOodb; KOodb: } public function showTables() { session_write_close(); return array_column($this->rawFetchAll("\123\x48\x4f\x57\x20\124\x41\x42\114\x45\x53"), "\x54\141\142\x6c\145\x73\137\151\156\137" . DB_NAME); } public function optimizeDB() { goto snA1F; NoySh: foreach ($tables as $table) { goto fAaSt; lKgZD: $analyzed[$table] = $this->rawFetch("\101\x4e\101\114\x59\132\x45\40\124\x41\102\x4c\105\40{$table}\x3b"); goto pjji1; pjji1: IPz35: goto vvO5Y; vvO5Y: PMT3p: goto VuHrF; ZHsYW: $checked[$table] = $this->rawFetch("\x43\110\105\103\113\x20\x54\x41\102\114\x45\40{$table}\x3b"); goto lKgZD; fAaSt: if (!(strpos($table, "\166\x77\137") === false)) { goto IPz35; } goto ZHsYW; VuHrF: } goto Isc2h; snA1F: session_write_close(); goto Ie0UY; l9Sg0: if (!$tables) { goto XphsV; } goto NoySh; sp8NW: $checked = []; goto Ewjbc; zFhoX: XphsV: goto NE9i7; NE9i7: return ["\x63\150\145\x63\x6b\x65\144" => $checked, "\x61\156\x61\x6c\x79\x7a\145\144" => $analyzed]; goto TwWVC; Ewjbc: $tables = $this->showTables(); goto l9Sg0; Isc2h: WS4VX: goto zFhoX; Ie0UY: $analyzed = []; goto sp8NW; TwWVC: } public function removeAllIndexes(array $excludes = []) { goto ctpuj; LMGnF: $qryExcludes = []; goto LQezO; D165d: foreach ($indexes as $idx) { goto chOOJ; PqFGk: $this->rawQuery($dropForeignKey); goto BcGqw; Yna7R: $dropForeignKey = sprintf("\101\114\124\x45\122\x20\124\x41\102\x4c\x45\40\140\x25\x73\140\40\104\122\117\120\x20\106\x4f\x52\x45\x49\x47\116\40\113\x45\131\x20\140\x25\163\x60\x3b", $this->table, $idx["\x4b\145\171\137\156\x61\x6d\x65"]); goto PqFGk; ovGYw: $this->rawQuery($dropIndex); goto Yna7R; chOOJ: $dropIndex = sprintf("\101\114\124\x45\x52\x20\x54\x41\102\114\x45\x20\140\45\x73\x60\x20\x44\122\x4f\x50\x20\x49\116\104\105\x58\40\140\x25\x73\x60\x3b", $this->table, $idx["\113\x65\x79\x5f\x6e\141\x6d\x65"]); goto ovGYw; BcGqw: dKrj0: goto EklKJ; EklKJ: } goto NiTFk; LQezO: foreach ($excludes as $idx) { $qryExcludes[] = "\x4b\x65\x79\137\156\141\x6d\x65\40\x3c\x3e\x20\47{$idx}\47"; vdbUe: } goto n5L5R; tnyhI: $indexes = $this->rawFetchAll(trim(sprintf("\123\x48\x4f\x57\x20\111\x4e\104\105\130\x45\x53\x20\106\x52\117\x4d\40\140\x25\x73\140\40\127\x48\105\122\x45\x20\113\x65\x79\x5f\156\141\x6d\145\40\74\76\x20\42\120\x52\x49\x4d\101\x52\x59\42\40\x61\156\x64\40\45\x73", $this->table, implode("\x20\141\x6e\x64\x20", $qryExcludes)), "\x20\x61\x6e\x64")); goto TVdfE; TVdfE: if (!$indexes) { goto YIrmx; } goto D165d; QERtl: return true; goto hrQoN; NiTFk: q4Gsc: goto pT3E5; n5L5R: H5HPA: goto tnyhI; pT3E5: YIrmx: goto QERtl; ctpuj: session_write_close(); goto LMGnF; hrQoN: } public function __destruct() { goto KxWm5; KxWm5: session_write_close(); goto T0KoU; rvXKo: Conn::getInstance()->disconnect(); goto prDEL; T0KoU: $this->resetVar(); goto rvXKo; prDEL: } }
