<?php
/*   __________________________________________________
    |  Obfuscated by YAK Pro - Php Obfuscator  2.0.16  |
    |              on 2025-05-18 20:27:37              |
    |    GitHub: https://github.com/pk-fr/yakpro-po    |
    |__________________________________________________|
*/
/*
Copyright @ 2020 - 2025 GDPlayer v4.7.1. https://gdplayer.to | https://t.me/gdplayerto
*/
 namespace GDPlayer; use GDPlayer\{Config, Core, FileStream, Helper, InstanceCache, Security}; abstract class StreamHelper extends \GDPlayer\StreamSetter { private Core $core; private Security $security; private $ch; private $cacheMode = "\x70\150\x70"; private $cacheProcessKey = ''; private $cacheTimeout = 3600; private $contentLength = 0; private $defaultHeaders = []; private $fpChunk = false; private $isApple = false; private $rangeBytes = ''; private $tmpCacheFile = ''; private $totalLengthKey = ''; protected int $start = 0; protected int $end = 0; protected int $totalLength = 0; protected $ampQry = "\46"; protected $vHost = ''; protected $vID = ''; protected $vURL = ''; protected $contentType = "\141\x70\160\154\x69\x63\x61\x74\151\x6f\x6e\57\x6f\x63\164\145\164\x2d\x73\x74\162\x65\x61\155"; protected $isLive = false; protected $copyrightText = "\107\104\x50\154\x61\x79\145\162\x20\x28\143\51\40\x32\60\x32\x30\176\x20\x7c\40\x67\x64\x70\154\x61\x79\x65\162\56\x74\157\x20\174\40\x40\x67\x64\160\x6c\x61\x79\145\162\x74\157"; protected $cacheFile = ''; protected $binExtensions = []; protected $config = []; public function __construct(string $vHost = '', string $vID = '', string $url = '') { goto blxQn; ZBN4C: $this->vID = $vID; goto Fm0BC; LBmHk: $cleanUrl = rtrim($cleanUrl, "\x20\x2f\134\12\15\x9\13\0\x3f\x26\x23"); goto yEb47; hUJS2: $this->vURL = $cleanUrl; goto NBvuE; NBvuE: if (!(empty($this->vURL) || !validateUrl($this->vURL))) { goto B0aEL; } goto wmbLW; K6yhv: if (ob_get_level()) { goto jFmEt; } goto rKBSM; gxRYw: $this->getRangeRequest(); goto QSzr7; WqYEn: $this->cacheTimeout = $this->core->getTimeout($vHost); goto C7gmO; nw_2P: $this->vURL = str_replace(["\45\62\x46", "\45\x32\146"], "\57", $this->vURL); goto gR8D4; rKBSM: ob_start(); goto ouT2A; Kj8uQ: if (empty($this->config["\143\x61\x63\150\145\137\x6d\x6f\x64\x65"])) { goto Q3hsW; } goto Vi3d1; IprC6: $cleanUrl = preg_replace("\x2f\45\62\x5b\146\x46\135\x24\x2f", '', $url, 1); goto LBmHk; C7gmO: $this->isApple = isAppleProduct(); goto Kj8uQ; BwVWF: $this->ampQry = "\46\141\155\x70\x3b"; goto SnH4Z; mEd7U: $this->config = Config::getMulti(["\143\x61\143\150\145\137\x6d\x6f\144\x65", "\x65\x6e\x61\142\x6c\x65\137\143\x61\x63\x68\x65\x5f\x66\x69\x6c\145", "\160\x72\157\144\165\x63\x74\x69\157\156\137\x6d\x6f\144\x65"]); goto Ge84i; Vi3d1: $this->cacheMode = $this->config["\143\141\143\x68\x65\137\x6d\x6f\x64\145"]; goto k01oG; gR8D4: HQ8Ii: goto ezMII; H7zEi: $this->vHost = $vHost; goto ZBN4C; k01oG: Q3hsW: goto ejioW; kZlF2: $url = sanitizeUrl($url); goto IprC6; Ge84i: $this->binExtensions = getBinFileContent("\143\165\163\164\157\x6d\55\x65\x78\x74\145\x6e\163\151\x6f\156\163\56\x6a\163\157\156"); goto WqYEn; ezMII: if (!$this->isMPD) { goto dpOPQ; } goto BwVWF; Fm0BC: if (!($this->vHost === "\x72\165\155\x62\x6c\x65")) { goto HQ8Ii; } goto nw_2P; SnH4Z: dpOPQ: goto mEd7U; knwov: $this->core = new Core(); goto uCLqr; OQXls: $this->totalLengthKey = "\x66\x69\154\145\x73\x69\172\145\x5f" . createHash($this->vURL); goto gxRYw; ejioW: $this->defaultHeaders = corsResponseHeaders(); goto Vd1E5; uCLqr: $this->security = new Security(); goto H7zEi; wmbLW: redirectTo(BASE_URL . "\x34\x30\64"); goto nYTSp; Vd1E5: $this->responseHeaders = $this->defaultHeaders; goto OQXls; yEb47: $cleanUrl = str_replace("\x5f\x32\146\x5f", "\45\62\x46", $cleanUrl); goto hUJS2; ouT2A: jFmEt: goto kZlF2; blxQn: session_write_close(); goto K6yhv; nYTSp: B0aEL: goto knwov; QSzr7: } private function getRangeRequest() { goto k9Vr6; IvxOX: if ($this->start === 0 && $this->end === 0) { goto wKUQC; } goto YN4yr; gRcpu: [$this->start, $this->end] = array_map("\x69\156\164\166\x61\x6c", array_pad(explode("\x2d", $this->rangeBytes), 2, 0)); goto v2l3K; v2l3K: $cacheTotalLength = InstanceCache::getItem($this->totalLengthKey); goto IvxOX; aYhO0: return; goto GcFWl; fa6Uz: $this->totalLength = (int) $cacheTotalLength->get(); goto P_B3Z; sPjlx: wKUQC: goto BdDEv; P_B3Z: $this->end = min($this->start + 2999999, $this->totalLength - 1); goto z5w3B; z5w3B: $rawRange = sprintf("\x62\x79\x74\145\163\75\45\144\x2d\x25\x64", $this->start, $this->end); goto qz0y4; Q5Yar: session_write_close(); goto JIU3R; gIEtx: $this->rangeBytes = trim(str_replace("\x62\171\x74\x65\163\75", '', $rawRange)); goto gRcpu; XPz4D: $this->requestHeaders[] = "\122\x61\x6e\147\x65\72\40" . $rawRange; goto QGTa8; tD7wg: $rawRange = sprintf("\x62\171\164\x65\163\x3d\45\x64\x2d\x25\144", $this->start, $this->end); goto doMhF; JIU3R: $rawRange = $_SERVER["\x48\124\124\120\137\x52\101\x4e\107\105"]; goto gIEtx; BdDEv: $this->end = 1; goto tD7wg; doMhF: goto mDbgW; goto KG0jw; qz0y4: mDbgW: goto XPz4D; YN4yr: if (!$cacheTotalLength->isEmpty()) { goto t47Qd; } goto ep8Dw; k9Vr6: if (!empty($_SERVER["\x48\124\x54\x50\x5f\122\x41\x4e\107\x45"])) { goto CXLbi; } goto aYhO0; ep8Dw: goto mDbgW; goto sPjlx; GcFWl: CXLbi: goto Q5Yar; KG0jw: t47Qd: goto fa6Uz; QGTa8: } public function setCacheFile(string $label = "\117\162\151\x67\x69\156\x61\154") { goto ixWpa; nNryX: return; goto trtnE; pRNs0: goto TKWMd; goto jfSy4; yfFG1: H6rIe: goto A2U4n; lAH5n: $basename = SLASH . basename($this->cacheFile); goto Hc7Fp; AGgsX: $this->cacheProcessKey = "\163\x61\x76\x65\55\x63\141\x63\x68\145\x5f" . createHash($this->vURL); goto i3304; NXHQ0: $cacheFile = Helper::createCacheDir($this->vHost, $this->vID) . SLASH . $label . "\56\155\x70\x34"; goto zE5KO; cbe18: $cacheFile = Helper::createCacheDir($this->vHost, $this->vID, $this->vURL, $this->rangeBytes); goto Q5L1Q; A2U4n: sWMYe: goto pRNs0; zE5KO: $this->cacheFile = customRealPath($cacheFile); goto mq_F9; F0qU6: if ($this->config["\x65\x6e\141\x62\154\145\x5f\x63\x61\x63\x68\x65\137\x66\x69\x6c\x65"]) { goto OxHLB; } goto nNryX; ixWpa: session_write_close(); goto F0qU6; i3304: if (InstanceCache::getItem($this->cacheProcessKey)->isHit()) { goto sWMYe; } goto lAH5n; eANIs: if ($this->isMP4) { goto Dru7B; } goto cbe18; HEZL0: stream_set_chunk_size($this->fpChunk, SMALL_BUFFER_SIZE); goto PvIOv; jfSy4: Dru7B: goto NXHQ0; Q5L1Q: $this->cacheFile = customRealPath($cacheFile); goto AGgsX; PvIOv: stream_set_write_buffer($this->fpChunk, SMALL_BUFFER_SIZE); goto yfFG1; jE7Ud: InstanceCache::setItem($this->cacheProcessKey, $this->tmpCacheFile, 3600, "\163\141\x76\145\x2d\143\x61\x63\150\145"); goto l1Ex9; x21gT: flock($this->fpChunk, LOCK_EX); goto HEZL0; i9ua9: if (!($this->fpChunk = @fopen($this->tmpCacheFile, "\x61\x62"))) { goto H6rIe; } goto x21gT; trtnE: OxHLB: goto eANIs; Hc7Fp: $tmpBasename = SLASH . pathinfo($this->cacheFile, PATHINFO_FILENAME) . "\x2e\x74\x6d\x70"; goto RjNBX; RjNBX: $this->tmpCacheFile = customRealPath(strtr($this->cacheFile, [$basename => $tmpBasename])); goto jE7Ud; mq_F9: TKWMd: goto ROohN; l1Ex9: createDir(normalizeSeparator(dirname($this->tmpCacheFile))); goto i9ua9; ROohN: } private function parseBaseUrl(string $val) { goto OTVIO; fSFOF: Hv047: goto teG_w; wmbme: $url .= dirname(parse_url($this->vURL, PHP_URL_PATH)) . SLASH; goto VTegG; g9IWq: $url = $val; goto qXAYt; T4_XV: if (substr($val, 0, 1) === SLASH) { goto Z6j2r; } goto dTmvA; EMwB5: $url .= substr_replace($val, '', 0, 2); goto D3CS3; rVazs: $url = Helper::getHostOrigin($this->vURL, true); goto wmbme; teG_w: $path = parse_url($this->vURL, PHP_URL_PATH); goto dWe2I; qXAYt: goto vf8L3; goto mq2SF; nm023: return $url; goto j0ZJP; WwYH8: if (validateUrl($val)) { goto UeEh4; } goto T4_XV; HUwRV: $url = strtr($this->vURL, [$basename => '']); goto EMwB5; mq2SF: Z6j2r: goto otk0I; gpbTb: UeEh4: goto g9IWq; dWe2I: $basename = basename($path); goto HUwRV; otk0I: $url = Helper::getHostOrigin($this->vURL, true) . $val; goto BnP8U; dTmvA: if (substr($val, 0, 2) === "\56\57") { goto Hv047; } goto rVazs; OTVIO: session_write_close(); goto WwYH8; D3CS3: vf8L3: goto nm023; BnP8U: goto vf8L3; goto fSFOF; hx2uy: goto vf8L3; goto gpbTb; VTegG: $url .= ltrim($val, SLASH) . SLASH; goto hx2uy; j0ZJP: } protected function addTokenToUrl(string $url = '') { goto BNG9r; KZ9wr: if (empty($parsedUrl["\x70\141\164\x68"])) { goto fB07U; } goto OMg2D; Skkx0: o2PPS: goto lu7tz; scDX5: $qry .= $this->ampQry . "\x67\x74\x3d" . $this->token; goto b0lKM; VxFOe: $qry = "\77"; goto qdRkM; BNG9r: session_write_close(); goto PVjQ2; ANO8c: if (empty($parsedUrl["\146\x72\141\x67\155\x65\x6e\x74"])) { goto k_m_p; } goto AZJ1r; lu7tz: if (empty($this->token)) { goto P6MBi; } goto scDX5; AZJ1r: $newUrl .= "\x23" . $parsedUrl["\146\x72\141\x67\x6d\145\x6e\164"]; goto RLM3z; OMg2D: $newUrl .= ltrim($parsedUrl["\x70\x61\x74\x68"], SLASH); goto dfwyJ; IZFct: return $newUrl; goto WA2w_; qdRkM: if (empty($parsedUrl["\x71\x75\145\x72\x79"])) { goto o2PPS; } goto zLBvX; dfwyJ: fB07U: goto VxFOe; b0lKM: P6MBi: goto vkXYv; zLBvX: $qry .= $parsedUrl["\161\x75\x65\x72\x79"]; goto Skkx0; vkXYv: $newUrl .= strtr($qry, ["\x3f" . $this->ampQry => "\77"]); goto ANO8c; PVjQ2: $parsedUrl = parse_url($url); goto wB4PN; wB4PN: $newUrl = Helper::getHostOrigin($url, true) . SLASH; goto KZ9wr; RLM3z: k_m_p: goto IZFct; WA2w_: } private function normalizedPathParts(array $pathParts) { goto IeVwP; IeVwP: session_write_close(); goto dCorT; CQ2Uo: return $normalizedPathParts; goto ETmFZ; yTULt: foreach ($pathParts as $part) { goto DGw66; DGw66: if ($part === "\56\x2e") { goto sZ3wM; } goto ODyZ4; ODyZ4: if ($part !== "\x2e" && $part !== '') { goto IzEsp; } goto IIOwD; nGGUD: DpAzk: goto Y0Sq0; eOM7l: $normalizedPathParts[] = str_replace(["\45\x32\106", "\45\x32\x66"], "\137\62\x66\137", $part); goto nGGUD; Rvjjx: array_pop($normalizedPathParts); goto kLGEE; yVIhm: sZ3wM: goto Rvjjx; kLGEE: goto tiH5K; goto zxq_1; MLAZP: if (strpos($part, "\x25\62\106") !== false || strpos($part, "\45\62\x66") !== false) { goto S5Opz; } goto FLDef; c34cj: goto DpAzk; goto wdbCG; wdbCG: S5Opz: goto eOM7l; Y0Sq0: tiH5K: goto w_Mjl; FLDef: $normalizedPathParts[] = $part; goto c34cj; w_Mjl: Bs_ka: goto z0j7B; zxq_1: IzEsp: goto MLAZP; IIOwD: goto tiH5K; goto yVIhm; z0j7B: } goto BvEsA; dCorT: $normalizedPathParts = []; goto yTULt; BvEsA: twCEa: goto CQ2Uo; ETmFZ: } protected function bypassURL(string $val = '', string $separator = '') { goto S7fNz; prQBP: $filename = pathinfo($normalizedPath, PATHINFO_FILENAME); goto j5ySU; I2rKk: return $normalizedUrl; goto mWAN_; Q2uf6: $normalizedPath = strtr($normalizedPath, [$basename => $newBasename]); goto KFxfU; bpR19: $isPath = substr($val, -1) === SLASH; goto ghg7l; ghg7l: $url = $this->parseBaseUrl($val); goto xb36j; KFxfU: uOTbV: goto YMlBJ; Ve2R0: $extension = pathinfo($normalizedPath, PATHINFO_EXTENSION); goto LP2Ra; ngEhm: $basename = basename($normalizedPath); goto prQBP; YMlBJ: hF4hX: goto CA1tq; LP2Ra: if (empty($extension)) { goto hF4hX; } goto PYvUB; fcDfg: $normalizedPath = implode(SLASH, $normalizedPathParts); goto s_88W; S7fNz: session_write_close(); goto bpR19; FJYKR: if (empty($parsedUrl["\x70\141\164\150"])) { goto wLEvc; } goto J250M; DFGkK: $normalizedPathParts = $this->normalizedPathParts($pathParts); goto fcDfg; kaPQT: $normalizedUrl .= SLASH . $this->security->encryptURL($this->vHost . "\176" . $this->vID); goto YEyw1; SqS8L: $normalizedUrl .= trim(!empty($separator) ? $separator : $this->separator, SLASH); goto kaPQT; s_88W: wLEvc: goto Dp8ik; MMYQB: FPNjf: goto I2rKk; Dp8ik: $normalizedUrl = BASE_URL; goto SqS8L; YEyw1: $normalizedUrl .= SLASH . $this->security->encryptURL(Helper::getHostOrigin($url, true) . SLASH); goto Ve2R0; y2JVn: if (is_bool($originalKey)) { goto uOTbV; } goto ngEhm; NkSdG: $newBasename = $extension . "\137\x67\x78\137" . $filename . $customExtension; goto Q2uf6; CHP0O: if (empty($parsedUrl["\x66\x72\141\147\x6d\x65\x6e\164"])) { goto FPNjf; } goto Pi0qR; j5ySU: $customExtension = $this->binExtensions["\x63\165\163\x74\157\x6d"][$originalKey]; goto NkSdG; ujWhn: J3oM5: goto CHP0O; J250M: $pathParts = explode(SLASH, $parsedUrl["\160\141\164\150"]); goto DFGkK; fPQmO: if (empty($parsedUrl["\161\165\x65\162\x79"])) { goto J3oM5; } goto GwT0D; AACkx: $normalizedUrl = rtrim($normalizedUrl, "\57"); goto ujWhn; z527c: $normalizedPath = ''; goto FJYKR; xb36j: $parsedUrl = parse_url($url); goto z527c; Pi0qR: $normalizedUrl .= "\43" . $parsedUrl["\146\x72\x61\x67\x6d\x65\156\x74"]; goto gaQ_r; PYvUB: $originalKey = array_search("\56" . $extension, $this->binExtensions["\157\x72\151\x67\x69\x6e\x61\154"]); goto y2JVn; gaQ_r: $normalizedUrl = rtrim($normalizedUrl, "\x2f"); goto MMYQB; CA1tq: $normalizedUrl .= SLASH . $normalizedPath . ($isPath ? SLASH : ''); goto fPQmO; GwT0D: $normalizedUrl .= "\77" . $parsedUrl["\161\165\145\162\171"]; goto AACkx; mWAN_: } protected function playlistParser(string $content = '') { goto riD4m; zKTh5: if (!empty($content)) { goto pou1B; } goto JoVBy; JoVBy: createErrorLog([__FILE__, __FUNCTION__, $this->vURL, "\164\x68\x65\x20\x63\157\156\x74\x65\x6e\x74\x20\x69\x73\x20\145\155\x70\x74\171"]); goto LJ9vf; Ie10A: $content = preg_replace("\57\x5c\170\133\60\55\x39\101\55\106\141\x2d\x66\135\x7b\x32\x7d\x2f", '', $content); goto MjX_k; M2Y6Y: $this->contentType = "\x74\x65\x78\164\57\160\x6c\x61\151\x6e\x3b\x20\x63\x68\x61\x72\163\x65\164\75\165\164\x66\x2d\70"; goto Kjk3A; pHDIz: pou1B: goto a5Qr4; Kjk3A: e5d2m: goto slbKX; a5Qr4: $this->isMaster = true; goto Ie10A; LJ9vf: redirectTo(BASE_URL . "\x34\x30\64"); goto pHDIz; MjX_k: if (!(!$this->isApple && !in_array($_SERVER["\122\x45\121\125\x45\123\124\x5f\115\105\124\110\117\x44"], ["\x48\x45\x41\x44", "\x4f\x50\124\x49\117\x4e\x53"]))) { goto e5d2m; } goto M2Y6Y; TOyTU: $this->defaultResponseHeaders(); goto wHIKD; slbKX: $this->contentLength = mb_strlen($content); goto TOyTU; riD4m: session_write_close(); goto zKTh5; wHIKD: echo $content; goto GAEDN; GAEDN: } protected function defaultCurlConfig() { goto Fd5iW; A5xrr: curl_setopt($this->ch, CURLOPT_CUSTOMREQUEST, "\107\105\x54"); goto znFt3; zT35p: kcXAL: goto H2Obs; xkuQu: curl_setopt($this->ch, CURLOPT_STDERR, fopen(normalizeSeparator($verboseFile), "\167")); goto zT35p; wdyPB: $headers[] = "\x48\x6f\163\x74\x3a\40" . Helper::getHostOrigin($this->vURL); goto tpD1E; Fd5iW: session_write_close(); goto NmvZJ; QbBJl: curl_setopt($this->ch, CURLOPT_URL, $this->vURL); goto A5xrr; hF2rP: if ($this->config["\160\162\x6f\x64\x75\143\164\x69\157\156\x5f\x6d\157\x64\145"]) { goto kcXAL; } goto Etl2r; PFWU5: curl_setopt($this->ch, CURLOPT_VERBOSE, true); goto xkuQu; Etl2r: $verboseDir = sprintf("\x25\163\x2f\143\x61\x63\x68\145\x2f\163\164\162\x65\141\155\x69\x6e\147\57\45\x73\x2f", rtrim(BASE_DIR, SLASH), $this->vHost); goto lRQ_V; tpD1E: $this->ch = Helper::getCurlDefaultConfig(curl_init(), 0); goto QbBJl; lRQ_V: $verboseFile = $verboseDir . substr(keyFilter($this->vID), -200) . "\x2e\164\170\x74"; goto lH90D; NmvZJ: $headers = $this->requestHeaders; goto wdyPB; lH90D: createDir($verboseDir); goto PFWU5; znFt3: curl_setopt($this->ch, CURLOPT_HTTPHEADER, $headers); goto hF2rP; H2Obs: } protected function redirectTo(string $url = '', string $separator = '') { goto PpSEv; J2Boq: redirectTo($newUrl); goto bZ3Vz; QdEoW: $newUrl .= strpos($newUrl, "\x3f") !== false ? "\46\147\164\x3d" : "\x3f\147\x74\75"; goto JLApk; oOsN_: $newUrl = $this->bypassURL($url, $separator); goto QdEoW; JLApk: $newUrl .= $this->token; goto J2Boq; PpSEv: session_write_close(); goto oOsN_; bZ3Vz: } protected function loadCacheFileServer() { goto SJbwS; dyj3e: $this->responseHeaders[] = "\x58\x2d\101\143\143\x65\154\55\x52\x65\x64\x69\x72\x65\x63\x74\72\40" . $cacheFile; goto gUVWW; bX4a0: createResponseHeaders($this->responseHeaders, true, $this->cacheTimeout); goto UCgK_; PvPbz: if ($this->cacheMode === "\141\x70\x61\x63\150\x65") { goto nodOn; } goto FeEVW; m2jsF: if ($this->cacheMode === "\156\x67\x69\156\170") { goto Xstcm; } goto a6RKb; WgqSa: $this->responseHeaders[] = "\x58\55\101\x63\143\145\x6c\x2d\x42\x75\146\146\145\162\x69\156\x67\x3a\x20\156\157"; goto dyj3e; D0aJ5: $cacheFile = normalizeSeparator($this->cacheFile); goto Eg4__; qX_8b: F0d0B: goto uten8; c8KDe: $this->loadCacheFilePhp(); goto aL3ht; FeEVW: if ($this->cacheMode === "\154\x69\x74\145\163\x70\145\x65\144" || $this->cacheMode === "\x6e\147\151\x6e\170") { goto XO5JA; } goto uspnZ; gUVWW: ZWeFY: goto qX_8b; Tv8EJ: $filesDir = normalizeSeparator(CACHE_PATH . "\146\x69\x6c\x65\163\x2f"); goto D0aJ5; isMYG: goto F0d0B; goto dj_bX; Z2ZoC: goto ZWeFY; goto RkfOf; uten8: $this->responseHeaders[] = "\x58\55\x43\x61\143\x68\x65\55\x53\x65\x72\x76\x65\x72\x3a\40\x48\x49\x54"; goto KHnHd; gyoCv: goto F0d0B; goto IYGb2; UCgK_: exit; goto QjY4E; aL3ht: exit; goto gyoCv; dj_bX: XO5JA: goto Tv8EJ; AUOQx: $cacheFile = str_replace(DIRECTORY_SEPARATOR, SLASH, $cacheFile); goto m2jsF; iq9Zb: $this->responseHeaders[] = "\x43\157\156\x74\x65\156\x74\55\124\171\160\145\72\x20" . $this->contentType; goto bX4a0; RkfOf: Xstcm: goto WgqSa; uy46z: $this->responseHeaders[] = "\130\55\123\x65\156\144\146\151\154\x65\72\x20" . $this->cacheFile; goto isMYG; IYGb2: nodOn: goto uy46z; a6RKb: $this->responseHeaders[] = "\130\x2d\114\x69\x74\x65\x73\160\x65\145\x64\55\114\157\143\x61\164\x69\157\x6e\72\40" . $cacheFile; goto Z2ZoC; SJbwS: session_write_close(); goto oX6eH; oX6eH: if (!$this->isMP4 && !empty($this->rangeBytes)) { goto F1bC_; } goto PvPbz; uspnZ: goto F0d0B; goto rdCq0; KHnHd: $this->responseHeaders[] = "\x43\x6f\156\164\x65\x6e\164\55\x4c\145\x6e\147\x74\150\x3a\x20" . $this->contentLength; goto iq9Zb; Eg4__: $cacheFile = str_replace($filesDir, "\57\x63\141\143\x68\145\55\x66\x69\x6c\145\x73\x2f", $cacheFile); goto AUOQx; rdCq0: F1bC_: goto c8KDe; QjY4E: } protected function loadCacheFilePhp() { goto fOLZj; Dz6Lm: $this->responseHeaders[] = sprintf("\103\x6f\156\164\145\x6e\164\55\122\141\156\147\145\72\40\45\163\x2d\45\163\x2f\45\163", $this->start, $this->end, $this->totalLength); goto F8kUn; lvH5D: rbajN: goto I8T6W; Nr5fi: set_time_limit(0); goto gJWbO; GdAbs: $this->totalLength = @filesize($this->cacheFile) ?: 0; goto LFv6z; fOLZj: session_write_close(); goto w58D3; KTZOq: if (!empty($this->rangeBytes)) { goto rbajN; } goto d7xRP; F8kUn: Qnd2L: goto rKnn2; I8T6W: $this->contentLength = $this->end - $this->start + 1; goto Dz6Lm; Pu9RC: aSBJU: goto EcE5G; dQSXD: ob_flush(); goto QvOsF; QvOsF: flush(); goto ZCiYn; pjgbD: openResourcesHandler(); goto Nr5fi; rKnn2: $this->responseHeaders[] = "\130\x2d\x43\x61\x63\x68\x65\x3a\x20\110\x49\124"; goto DUQHg; w58D3: if (!($this->totalLength <= 0)) { goto piH2m; } goto GdAbs; HrP2m: goto Qnd2L; goto lvH5D; AQn7f: if (!($this->totalLength > 0)) { goto aSBJU; } goto KTZOq; LFv6z: piH2m: goto AQn7f; xi8oW: $this->defaultResponseHeaders(); goto pjgbD; d7xRP: $this->contentLength = $this->totalLength; goto HrP2m; ZCiYn: exit; goto Pu9RC; gJWbO: readfile($this->cacheFile); goto dQSXD; DUQHg: $this->responseHeaders[] = "\105\164\141\x67\72\40" . md5_file($this->cacheFile); goto xi8oW; EcE5G: } protected function loadLocalCache() { goto qfRtm; VpyM1: $this->loadCacheFilePhp(); goto xqMXs; Iek44: I5ueM: goto eipOA; bbFcA: $fileStream = new FileStream($this->cacheFile); goto oAjXC; oAjXC: $fileStream->setTitle($this->title); goto xxMdT; xqMXs: goto rb5iE; goto gSEtB; s1lKC: dWd2a: goto gKUQ6; Ps9_b: if ($this->isMP4) { goto ZqPQH; } goto VpyM1; eipOA: if ($this->cacheMode === "\x70\x68\160") { goto eaFs6; } goto dknxl; YzgD1: if (!(!file_exists($this->cacheFile) && !is_readable($this->cacheFile))) { goto Vz_WS; } goto LNahF; rIcYy: eaFs6: goto Ps9_b; DcIfK: Vz_WS: goto EU_SJ; LNahF: @unlink($this->cacheFile); goto IxTO3; vgdHb: goto dWd2a; goto rIcYy; qfRtm: session_write_close(); goto YzgD1; dknxl: $this->loadCacheFileServer(); goto vgdHb; IxTO3: return; goto DcIfK; kPw8x: rb5iE: goto s1lKC; EU_SJ: if (!$this->isApple) { goto I5ueM; } goto mQgvp; xxMdT: $fileStream->stream(); goto kPw8x; mQgvp: $this->contentType = getMimeType($this->cacheFile); goto Iek44; gSEtB: ZqPQH: goto bbFcA; gKUQ6: } protected function defaultResponseHeaders() { goto SFGx2; fxrp3: $this->responseHeaders[] = "\x43\157\156\x74\145\x6e\164\x2d\124\171\x70\145\72\x20" . $this->contentType; goto gcI8G; t0eCN: http_response_code(isset($_SERVER["\110\124\124\x50\137\x52\101\116\x47\x45"]) ? 206 : 200); goto ER6pZ; ER6pZ: createResponseHeaders($this->responseHeaders, $enableCache, $this->cacheTimeout); goto ZL_Cy; wroXp: $this->responseHeaders[] = "\x41\x63\x63\145\x70\164\x2d\122\x61\156\x67\x65\x73\x3a\40\x62\171\164\145\163"; goto fxrp3; XKnAk: if (empty($this->contentLength)) { goto CDTWf; } goto SeTC2; SeTC2: $this->responseHeaders[] = "\x43\x6f\x6e\164\x65\x6e\164\x2d\x4c\x65\156\x67\x74\150\72\x20" . $this->contentLength; goto SSTjj; SSTjj: CDTWf: goto wroXp; gcI8G: $enableCache = strpos($this->vURL, "\x74\151\155\x65\x2e\141\x6b\141\155\141\x69\x2e\143\157\155") !== false || $this->isLive || $this->isMaster ? false : true; goto t0eCN; SFGx2: session_write_close(); goto XKnAk; ZL_Cy: } private function closeFopen() { goto TxZbu; TxZbu: session_write_close(); goto wF8Gl; Bb5ht: flock($this->fpChunk, LOCK_UN); goto Olv9v; Olv9v: fflush($this->fpChunk); goto VGnTD; Xojvn: PTWUg: goto VliFf; VGnTD: fclose($this->fpChunk); goto Xojvn; wF8Gl: if (!is_resource($this->fpChunk)) { goto PTWUg; } goto Bb5ht; VliFf: } private function streamHeaderCallback($ch, string $header) { goto Ur9un; IWcHU: InstanceCache::setItem($this->totalLengthKey, $this->totalLength, CACHE_TIMEOUT, "\x63\141\143\x68\145\x2d\146\x69\154\x65\163\x69\172\x65"); goto BRNTC; MNjnS: $this->responseHeaders[] = trim($header); goto RwBUZ; BRNTC: Y_RNa: goto MNjnS; ZOEtE: if (!($this->totalLength <= 0)) { goto Y_RNa; } goto mtWt8; mtWt8: $ex = explode("\x2f", $v); goto fHVu1; fHVu1: $this->totalLength = intval(end($ex)); goto IWcHU; d8IQH: if ($k === "\x63\x6f\156\x74\x65\x6e\164\x2d\162\x61\x6e\x67\145") { goto qvrxx; } goto m7xyY; g9cLZ: $status = curl_getinfo($ch, CURLINFO_RESPONSE_CODE); goto kwGeN; Wo4ur: if ($k === "\143\x6f\x6e\164\x65\x6e\x74\55\154\145\156\147\164\x68" && (int) $v > 0) { goto UjohM; } goto d8IQH; nEB8N: kC7n2: goto UoQKV; WIRB_: UjohM: goto i60qA; kwGeN: if (!($status >= 200 && $status < 400)) { goto kC7n2; } goto N8I_I; m7xyY: goto byMcH; goto WIRB_; i60qA: $this->responseHeaders[] = trim($header); goto hZxu0; N8I_I: list($k, $v) = array_pad(explode("\x3a", strtolower($header)), 2, ''); goto Wo4ur; oymBd: qvrxx: goto ZOEtE; GH4jd: return strlen($header); goto nEB8N; hZxu0: goto byMcH; goto oymBd; UoQKV: return 0; goto UNxCV; RwBUZ: byMcH: goto GH4jd; Ur9un: session_write_close(); goto g9cLZ; UNxCV: } private function streamWriteCallback($ch, string $chunk) { goto u71EB; u7ew_: ob_flush(); goto zsWAS; lJiZn: if (!connection_aborted()) { goto ZAmYl; } goto BF11b; fHlrd: return 0; goto ErcKu; Xq0w0: ZAmYl: goto tM6U6; mAqiw: fwrite($this->fpChunk, $chunk); goto qMqMS; tM6U6: if (headers_sent()) { goto ecS8_; } goto JdOoc; qMqMS: JXSsR: goto lJiZn; dOclp: $this->closeFopen(); goto URCWp; Eov0c: return strlen($chunk); goto Rrkkj; JdOoc: $this->defaultResponseHeaders(); goto nxxFB; nxxFB: ecS8_: goto XgONs; BF11b: curl_setopt($ch, CURLOPT_TIMEOUT_MS, 1); goto dOclp; XgONs: echo $chunk; goto u7ew_; Rrkkj: BQZew: goto fHlrd; u71EB: session_write_close(); goto QzF8I; URCWp: @unlink($this->tmpCacheFile); goto Jh5yI; Jh5yI: return 0; goto Xq0w0; QzF8I: $status = curl_getinfo($ch, CURLINFO_RESPONSE_CODE); goto sydO0; arP1W: if (!(!empty($this->tmpCacheFile) && is_resource($this->fpChunk))) { goto JXSsR; } goto mAqiw; sydO0: if (!($status >= 200 && $status < 400)) { goto BQZew; } goto arP1W; zsWAS: flush(); goto Eov0c; ErcKu: } protected function getMasterContent() { goto CMaik; N8fT7: goto WzVoo; goto BIgP2; oAWl4: $status = curl_getinfo($this->ch, CURLINFO_RESPONSE_CODE); goto itWdQ; USdEn: createErrorLog([__FILE__, __FUNCTION__, $this->vHost, $this->vID, $this->vURL, $status, $err]); goto N8fT7; h0xtw: getVideoAttemptFailed($this->vHost, $this->vID); goto R_zKO; zCIaI: if (!(!empty($effectiveUrl) && $this->vURL !== $effectiveUrl)) { goto qRwcI; } goto gibZM; gibZM: $this->vURL = $effectiveUrl; goto H9X43; n_f1l: if ($status >= 200 && $status < 400 && (stripos($content, "\43\105\x58\124") !== false || stripos($content, "\x4d\120\104") !== false)) { goto xEHGz; } goto USdEn; CMaik: session_write_close(); goto Brx_D; Wm3ok: $err = curl_error($this->ch); goto Id90u; H9X43: qRwcI: goto j6sUj; Brx_D: $result = false; goto QlBsK; gdwXe: $content = curl_exec($this->ch); goto oAWl4; itWdQ: $effectiveUrl = curl_getinfo($this->ch, CURLINFO_EFFECTIVE_URL); goto Wm3ok; orE4D: WzVoo: goto nJt6X; sDhQP: if ($status === 0 || $status === 400 || $status === 429 || $status >= 500) { goto h9tef; } goto n_f1l; QlBsK: $this->defaultCurlConfig(); goto e26BL; nJt6X: return $result; goto ao2rl; e26BL: curl_setopt($this->ch, CURLOPT_RETURNTRANSFER, true); goto m3iX6; HsR8V: xEHGz: goto zCIaI; Id90u: curl_close($this->ch); goto sDhQP; m3iX6: curl_setopt($this->ch, CURLOPT_BUFFERSIZE, SMALL_BUFFER_SIZE); goto gdwXe; R_zKO: goto WzVoo; goto HsR8V; j6sUj: $result = (string) str_replace("\57\x69\156\x64\145\x78\56\x6d\63\165\70\57\57\163\x70\x61\x72\x61\x6d\163", "\x2f\x73\x70\x61\162\x61\155\163", $content); goto orE4D; BIgP2: h9tef: goto h0xtw; ao2rl: } public function stream() { goto FNoqU; qtkaX: curl_setopt($this->ch, CURLOPT_TCP_KEEPINTVL, 10); goto YdQ0w; sN3RO: redirectTo(BASE_URL . "\x34\60\x34"); goto qj7F4; zH0pO: bohjj: goto YsP0z; NyxrX: set_time_limit(0); goto voHok; wctni: curl_setopt($this->ch, CURLOPT_WRITEFUNCTION, [$this, "\163\164\162\145\141\155\127\x72\x69\164\145\x43\141\x6c\154\x62\141\x63\x6b"]); goto NyxrX; voHok: curl_exec($this->ch); goto SkpJd; qdL42: goto Q0e53; goto KJFrj; qj7F4: Q0e53: goto gFwEH; Nbu7r: curl_setopt($this->ch, CURLOPT_RETURNTRANSFER, false); goto ijKVT; YdQ0w: curl_setopt($this->ch, CURLOPT_MAX_RECV_SPEED_LARGE, defined("\115\101\x58\x5f\104\x4f\x57\x4e\x4c\117\x41\x44\x5f\x53\x50\x45\x45\104") ? MAX_DOWNLOAD_SPEED : 0); goto Ldfj7; D0Had: if ($status < 200 || $status >= 404) { goto Hb11a; } goto AfW5y; dPxYx: $err = curl_error($this->ch); goto PNk4S; fn2u6: curl_setopt($this->ch, CURLOPT_TCP_KEEPALIVE, 1); goto OnA5h; KJFrj: Hb11a: goto EGw0r; r7P7e: createErrorLog([__FILE__, __FUNCTION__, $this->vURL, $status, $err]); goto D8mHj; BYy8e: $this->loadLocalCache(); goto DkKen; Ldfj7: curl_setopt($this->ch, CURLOPT_BUFFERSIZE, BUFFER_SIZE); goto Nbu7r; ijKVT: curl_setopt($this->ch, CURLOPT_HEADERFUNCTION, [$this, "\163\x74\x72\145\141\x6d\x48\145\141\x64\145\x72\x43\141\154\x6c\142\141\x63\153"]); goto wctni; YM0Gg: if ($status === 0 || $status >= 400 && $status < 404 || $status === 429 || $status >= 500) { goto g0dFK; } goto D0Had; R3Q3n: goto zkPOY; goto zH0pO; EGw0r: createErrorLog([__FILE__, __FUNCTION__, $this->vURL, $status, $err]); goto sN3RO; FNoqU: session_write_close(); goto BYy8e; D8mHj: redirectTo(BASE_URL . "\64\60\x34"); goto R3Q3n; fntvP: if ($this->isMP4) { goto bohjj; } goto r7P7e; DugdY: $this->closeFopen(); goto YM0Gg; JokEh: zkPOY: goto qdL42; DkKen: $this->defaultCurlConfig(); goto fn2u6; SkpJd: $status = curl_getinfo($this->ch, CURLINFO_RESPONSE_CODE); goto dPxYx; YsP0z: getVideoAttemptFailed($this->vHost, $this->vID); goto JokEh; OnA5h: curl_setopt($this->ch, CURLOPT_TCP_KEEPIDLE, 30); goto qtkaX; a75Rj: createErrorLog([__FILE__, __FUNCTION__, $this->vURL, $status, $err]); goto fntvP; rIeIP: g0dFK: goto a75Rj; PNk4S: curl_close($this->ch); goto DugdY; AfW5y: goto Q0e53; goto rIeIP; gFwEH: } public function __destruct() { goto U8Lqa; UOae_: @unlink($this->tmpCacheFile); goto kfrKF; YPklx: InstanceCache::deleteItem($this->cacheProcessKey); goto vzy3u; kfrKF: ccGTk: goto altyh; Vut5h: $this->ch = null; goto L1_m2; a6qLo: goto ccGTk; goto KU4ix; LvKSV: @rename($this->tmpCacheFile, $this->cacheFile); goto a6qLo; U8Lqa: session_write_close(); goto fcHVY; KU4ix: IWn3_: goto cOXqr; L1_m2: unset($this->ch); goto CS4bF; zDAON: goto ccGTk; goto PLNkY; fcHVY: if (connection_status() === CONNECTION_NORMAL && !empty($this->tmpCacheFile) && intval(@filesize($this->tmpCacheFile)) > 0) { goto ndr5T; } goto Y0lQQ; Y0lQQ: if (file_exists($this->tmpCacheFile)) { goto IWn3_; } goto zDAON; cOXqr: clearstatcache(true, $this->tmpCacheFile); goto UOae_; PLNkY: ndr5T: goto LvKSV; altyh: if (empty($this->cacheProcessKey)) { goto BEI19; } goto YPklx; vzy3u: BEI19: goto Vut5h; CS4bF: } }
