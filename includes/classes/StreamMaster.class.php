<?php
/*   __________________________________________________
    |  Obfuscated by YAK Pro - Php Obfuscator  2.0.16  |
    |              on 2025-05-18 20:27:37              |
    |    GitHub: https://github.com/pk-fr/yakpro-po    |
    |__________________________________________________|
*/
/*
Copyright @ 2020 - 2025 GDPlayer v4.7.1. https://gdplayer.to | https://t.me/gdplayerto
*/
 namespace GDPlayer; use GDPlayer\{Config, Core, GoogleDriveRestAPI, Helper, HLS, InstanceCache, MPD, Security, MP4}; use GDPlayer\Model\VideoHash; class StreamMaster { private Core $core; private GoogleDriveRestAPI $gdAPI; private Security $security; private VideoHash $vHash; private $vPlayer; private $acceptLanguage = ''; private $cookie = ''; private $userAgent = ''; private $clientIp = ''; private $isMaster = false; private $isMP4 = false; private $origin = ''; private $referer = ''; private $title = ''; private $uri = []; private $url = ''; private $vEmail = ''; private $vHost = ''; private $vID = ''; private $vLabel = "\117\162\x69\x67\x69\x6e\x61\x6c"; private $separator = "\57\x73\x74\x72\145\141\155\55\x76\151\x64\57"; private $requestHeaders = []; private $token = ''; private $lastModified = 0; private $isDownloadable = false; public function __construct(string $separator = "\57\x73\164\x72\145\141\155\55\x76\x69\144\x2f", bool $isMP4 = false, bool $isMaster = false) { goto PUjkd; J27EU: $this->isDownloadable = !empty($_GET["\144\154"]); goto Ws_18; Fq9Mx: $this->parseRequestHeaders(); goto h_hYW; lbg_2: $this->parseDataSources($data); goto UD44D; DANU7: $this->acceptLanguage = $dataSources["\154\x61\x6e\x67"]; goto Cwzdu; kPT46: redirectTo(BASE_URL . "\64\60\63"); goto oJgpx; TCmP1: $this->clientIp = $dataSources["\x69\x70"]; goto e5zpz; y4EmT: if ($this->security->mekNgumbe()) { goto j6yGz; } goto kPT46; Cwzdu: ZMOR8: goto chfCS; T3Mq1: getVideoAttemptFailed($this->vHost, $this->vID); goto azqz4; oJgpx: j6yGz: goto RrTCX; Y5PdX: $dataSources = $this->core->getDataSources(); goto IyblF; gEgKs: Dcw8L: goto DtePO; PUjkd: session_write_close(); goto pImzJ; KXovo: $this->core->setDownload($this->isDownloadable); goto Y5PdX; iVtNt: $this->core->setQuery(["\150\157\163\164" => $this->vHost, "\x69\144" => $this->vID]); goto KXovo; gGC2X: $this->acceptLanguage = ACCEPT_LANGUAGE; goto HEGiN; WGZ_j: $this->gdAPI = new GoogleDriveRestAPI(); goto b8QaX; G0rF7: $this->core = new Core(); goto WGZ_j; DtePO: $data = @json_decode($dataSources["\x64\141\164\x61"], true); goto lbg_2; b8QaX: $this->vHash = VideoHash::getInstance(); goto gGC2X; pImzJ: $this->separator = $separator; goto POek8; Ws_18: $this->token = $_GET["\x67\164"] ?? ''; goto FEsqF; YkLPB: $this->parseCustomHeaders(); goto Fq9Mx; bMsEY: $this->isMaster = $isMaster; goto J27EU; qlQYw: ZtAsA: goto T3Mq1; RrTCX: $this->security->enableUAFilter(); goto S0tiH; wtUrm: $this->parseUri(); goto iVtNt; uWJmU: if (empty($dataSources["\151\160"])) { goto tdfuq; } goto TCmP1; IyblF: if ($dataSources) { goto Dcw8L; } goto c_PQE; OlJhr: $this->clientIp = getUserIP(); goto wtUrm; bvGfA: goto W7lic; goto gEgKs; azqz4: W7lic: goto lFiDg; HEGiN: $this->userAgent = USER_AGENT; goto OlJhr; UD44D: $this->lastModified = $dataSources["\x63\x72\145\x61\x74\145\144"] ?? time(); goto yPIiP; MuTvG: $this->userAgent = $dataSources["\165\x61"]; goto SI3MC; POek8: $this->isMP4 = $isMP4; goto bMsEY; h_hYW: goto W7lic; goto qlQYw; chfCS: if (empty($dataSources["\x75\x61"])) { goto BZAvl; } goto MuTvG; FEsqF: $this->security = new Security(); goto y4EmT; SI3MC: BZAvl: goto uWJmU; yPIiP: if (empty($dataSources["\x6c\x61\x6e\147"])) { goto ZMOR8; } goto DANU7; S0tiH: $this->validation(); goto G0rF7; c_PQE: if ($this->isMP4 || $this->isMaster) { goto ZtAsA; } goto bvGfA; e5zpz: tdfuq: goto YkLPB; lFiDg: } private function validation() { goto W2fon; O_oUb: goto oidqS; goto qiKCP; iht9C: U44LG: goto cnLTa; Dc0FN: $config = Config::getMulti(["\144\151\x73\x61\x62\x6c\x65\137\x76\141\154\151\144\x61\x74\x69\157\x6e", "\145\x6e\x61\142\154\145\x5f\x64\157\x77\156\154\157\141\144\137\x70\141\x67\x65", "\147\144\x72\x69\166\x65\137\x68\154\163", "\x70\62\x70"]); goto ni9Bt; qiKCP: NEB6I: goto yg76e; eC0lQ: goto oidqS; goto JkqFf; ni9Bt: if (!($config["\x64\x69\x73\141\142\154\145\137\x76\x61\x6c\x69\144\x61\x74\151\157\x6e"] || $config["\160\62\x70"] || $this->security->isSmartTv())) { goto ss_Ux; } goto Qrsmy; CIbkp: PnxVd: goto gqV9q; Qrsmy: return; goto icZYK; kN2Bo: if (!($this->isMP4 && $fetchDest !== "\166\x69\144\145\157" || $this->isMaster && $fetchDest !== "\145\155\x70\164\171")) { goto U44LG; } goto lay_2; JkqFf: Fxklo: goto QUQf7; QUQf7: $fetchDest = $_SERVER["\x48\x54\124\x50\x5f\x53\105\103\x5f\x46\105\x54\x43\110\x5f\x44\105\123\x54"]; goto kN2Bo; gqV9q: redirectTo(BASE_URL . "\x34\60\63"); goto O_oUb; cnLTa: goto oidqS; goto CIbkp; yg76e: redirectTo(BASE_URL . "\x34\x30\63"); goto x4W5g; W2fon: session_write_close(); goto Dc0FN; lay_2: redirectTo(BASE_URL . "\64\x30\63"); goto iht9C; rMQGC: if (($this->isMaster || $this->isMP4) && !corsPolicyValidation($this->token)) { goto NEB6I; } goto eC0lQ; x4W5g: oidqS: goto wrI4P; cgqtE: if ($this->isDownloadable && !$config["\x65\x6e\141\x62\x6c\145\x5f\144\x6f\x77\156\x6c\157\x61\x64\x5f\160\141\x67\145"]) { goto PnxVd; } goto rMQGC; n8tri: if (!$this->isDownloadable && !isSafari() && isset($_SERVER["\110\124\x54\x50\x5f\125\x53\x45\122\137\x41\x47\105\116\124"], $_SERVER["\x48\x54\124\120\137\123\105\x43\x5f\106\105\124\x43\110\137\x44\x45\x53\x54"])) { goto Fxklo; } goto cgqtE; icZYK: ss_Ux: goto n8tri; wrI4P: } private function parseUri() { goto v79lA; j70Su: parse_str($_SERVER["\x51\125\x45\122\131\x5f\x53\x54\122\111\116\107"], $qry); goto Qpmd7; X0zLu: CAtvI: goto WeeAW; nG0f1: itKrE: goto Y9smA; l4N6T: if (empty($_SERVER["\121\125\x45\x52\131\137\x53\124\x52\111\x4e\x47"])) { goto On1VI; } goto j70Su; dgzus: $vHostIdOrHashId = ''; goto pq5dF; LciMF: if (!$data) { goto CKyL5; } goto u0ixi; xIbRD: array_splice($this->uri, 0, 2); goto T7f5w; A3lMG: $baseUrl = str_replace("\x5c", '', $uri0); goto Z0d74; B8NX2: $this->url .= "\77" . buildQueryNoIndex($qry); goto Gc9sE; u0ixi: $this->vHost = $data["\x68\x6f\163\164"]; goto co_DR; bJTJX: if (!($this->vHost === "\146\141\143\x65\x62\157\x6f\153")) { goto bmHmz; } goto h8K52; Gc9sE: On1VI: goto dN1di; vscQ7: $this->uri = $uri; goto dgzus; OzT8q: BoXem: goto B8NX2; o7klP: goto j2jfM; goto jEwJs; pq5dF: if (empty($this->uri[0])) { goto ibhZs; } goto sifIV; DAa5u: list($this->vHost, $this->vID) = array_pad($urlData, 2, ''); goto xIbRD; p4gGp: j2jfM: goto bJTJX; tC7eL: $data = $this->vHash->getOne(["\150\x6f\163\164", "\x68\x6f\163\x74\137\x69\144"]); goto LciMF; o4Pun: goto j2jfM; goto nG0f1; lszxa: CKyL5: goto o7klP; V_w0P: if (empty($this->uri[1])) { goto uzjW1; } goto NzLBN; R_m6b: $this->url .= "\x23" . $fragment; goto X0zLu; i1ieT: bmHmz: goto vWT8T; KrgLI: $uri = getPageUris(); goto y0KRi; S4LUd: uzjW1: goto T_j3B; co_DR: $this->vID = $data["\150\x6f\163\x74\x5f\x69\144"]; goto lszxa; WeeAW: $this->url = trim($this->url, "\x3f\43\x26"); goto p4gGp; T7f5w: $this->url = $baseUrl . implode(SLASH, $this->uri); goto l4N6T; trE3g: if (!empty($vHostIdOrHashId) && isset($this->uri[1])) { goto V7llB; } goto o4Pun; T_j3B: if (is_numeric($vHostIdOrHashId)) { goto itKrE; } goto trE3g; xwcUn: ibhZs: goto V_w0P; NzLBN: $this->vLabel = ucwords(trim($this->uri[1])); goto S4LUd; Zxr3A: $this->userAgent = "\x55\163\145\162\55\101\x67\145\156\164\x3a\x20" . $bots[array_rand($bots)] . "\57\x31\x2e" . random_int(0, 9); goto i1ieT; Z0d74: $urlData = explode("\x7e", $vHostIdOrHashId); goto DAa5u; v79lA: session_write_close(); goto KrgLI; h8K52: $bots = ["\x42\151\156\147\142\157\164", "\x59\x61\x6e\x64\145\170\x42\x6f\x74", "\x47\x6f\157\x67\154\145\142\157\x74", "\131\x61\x6e\144\145\170\111\155\x61\147\x65\x73", "\x6d\x73\156\x62\x6f\x74", "\x47\157\x6f\147\x6c\x65\x62\x6f\x74\55\x49\155\141\x67\145", "\x59\x61\x6e\144\x65\x78\x42\x6c\157\147\x73", "\101\160\x70\154\145\x62\x6f\x74", "\107\157\x6f\x67\154\x65\x62\157\164\x2d\x76\x69\x64\x65\157", "\x59\141\156\x64\x65\170\x4d\x65\164\162\x69\153\x61", "\x41\x68\162\x65\x66\x73\102\x6f\x74\x2e\x46\x65\145\144\x73", "\107\157\157\147\x6c\x65\142\x6f\164\55\116\x65\x77\x73", "\131\141\156\144\145\x78\116\145\x77\163", "\106\x65\x65\144\154\171\102\157\x74"]; goto Zxr3A; sifIV: $vHostIdOrHashId = $this->security->decryptURL($this->uri[0]); goto xwcUn; jEwJs: V7llB: goto sH1hL; dN1di: $fragment = parse_url($_SERVER["\x52\105\x51\125\x45\123\x54\137\x55\122\x49"], PHP_URL_FRAGMENT); goto uQ1ej; Qpmd7: $removeKeys = ["\x5f", "\147\x64", "\147\x6c", "\x67\170", "\147\x78\162", "\x67\164", "\x64\141\x74\141", "\154\x69\x76\145", "\x74\157\153\x65\x6e", "\162\x65\164\162\x79"]; goto VVIgb; y0KRi: array_splice($uri, 0, 1); goto vscQ7; Y9smA: $this->vHash->setCriteria("\151\x64", $vHostIdOrHashId); goto tC7eL; VVIgb: foreach ($removeKeys as $k) { unset($qry[$k]); ms9Lv: } goto OzT8q; sH1hL: $uri0 = $this->security->decryptURL($this->uri[1]); goto A3lMG; uQ1ej: if (empty($fragment)) { goto CAtvI; } goto R_m6b; vWT8T: } private function parseDataSources($data = null) { goto DI1Eo; Hkut7: $key = array_search($this->vLabel, array_column($data["\163\x6f\165\x72\143\x65\163"], "\154\x61\142\x65\154")); goto r2T3c; Ji9YU: $this->vEmail = $data["\x65\x6d\141\x69\154"]; goto t2Zh4; s2iaC: XWAqv: goto WwMXo; xorqW: ZV5Ww: goto s2iaC; TysWX: $this->title = trim($data["\164\x69\x74\x6c\145"]); goto DEqVO; r2T3c: if (!$key) { goto vNI0A; } goto xWUbw; aIWcS: if (!empty($data["\163\157\165\x72\143\x65\x73"])) { goto zlUjc; } goto o5gTm; DI1Eo: session_write_close(); goto aIWcS; o5gTm: getVideoAttemptFailed($this->vHost, $this->vID); goto ptfwf; DEqVO: $this->cookie = trim($data["\143\x6f\157\153\151\145\163"], "\x3b"); goto THVVe; oWrHn: vNI0A: goto p2dZX; yea30: zlUjc: goto TysWX; THVVe: $this->referer = $data["\162\x65\x66\145\162\x65\x72"]; goto Ji9YU; tIONo: if (!(in_array($this->vHost, directHosts()) && !isGoogleHls($this->vHost))) { goto ZV5Ww; } goto kZkvS; p2dZX: $this->url = str_replace("\x5c", '', $url); goto tIONo; kZkvS: redirectTo($this->url); goto xorqW; c9Xz_: $url = $data["\163\x6f\x75\162\143\145\163"][0]["\x66\x69\154\145"]; goto Hkut7; ptfwf: return; goto yea30; xWUbw: $url = $data["\x73\x6f\165\162\143\145\x73"][$key]["\x66\151\x6c\x65"]; goto oWrHn; t2Zh4: if (!(($this->isMP4 || $this->isMaster) && empty($this->url))) { goto XWAqv; } goto c9Xz_; WwMXo: } private function parseRequestHeaders() { goto FSPIX; rr5cd: $this->requestHeaders[] = "\x55\x73\x65\x72\55\101\x67\x65\156\x74\x3a\x20" . $this->userAgent; goto CdRU3; h6gHO: if (empty($this->cookie)) { goto ZjJoD; } goto J_ciK; OSJTt: $this->origin = Helper::getHostOrigin($this->referer, true); goto S_102; XdfFR: b03L4: goto h6gHO; wIFGh: $cacheHash = createHash($this->url . "\55" . $this->acceptLanguage . "\x2d" . $this->userAgent); goto sA04Z; b1itV: InstanceCache::save($cache); goto rYpTJ; Xyv_J: $saveHeaders = normalizeHeaders($this->requestHeaders); goto j3rAG; HWAzZ: $this->requestHeaders[] = "\x41\x63\143\145\160\x74\x2d\114\141\156\147\165\141\x67\x65\x3a\40" . $this->acceptLanguage; goto rr5cd; lQS7p: $this->requestHeaders = $cache->get(); goto im5v2; FSPIX: session_write_close(); goto EKhvM; J_ciK: $this->requestHeaders[] = "\x43\157\x6f\153\x69\145\72\x20" . trim(rawurldecode($this->cookie), "\73\x20"); goto O5wcK; t4xdV: tyfYk: goto zIFuA; zIFuA: if (!(!empty($this->referer) && $this->vHost !== "\164\x75\x72\x62\x6f\166\x69\x70\x6c\x61\171")) { goto b03L4; } goto enK59; im5v2: Wpr6i: goto DMdvV; sA04Z: $cache = InstanceCache::getItem($cacheKey . "\x5f" . $cacheHash); goto MXrW3; EKhvM: $cacheKey = implode("\137", ["\162\145\161\165\145\x73\164\55\x68\145\x61\x64\x65\x72\163", $this->vHost, substr(keyFilter($this->vID), 0, 250)]); goto wIFGh; MXrW3: if ($cache->isHit()) { goto X4Pq8; } goto HWAzZ; O5wcK: ZjJoD: goto Xyv_J; rYpTJ: goto Wpr6i; goto YtO2l; CdRU3: if (!(empty($this->origin) && !empty($this->referer))) { goto Cc2rC; } goto OSJTt; enK59: $this->requestHeaders[] = "\x52\x65\x66\x65\162\x65\162\x3a\x20" . $this->origin; goto XdfFR; YtO2l: X4Pq8: goto lQS7p; e6foh: $this->requestHeaders[] = "\117\162\x69\147\151\x6e\72\40" . $this->origin; goto t4xdV; T00a3: if (!(!empty($this->origin) && !in_array($this->vHost, ["\x64\157\x6f\144", "\x6d\x70\64\x75\160\154\x6f\x61\x64"]))) { goto tyfYk; } goto e6foh; GuOM3: $cache->set($saveHeaders)->expiresAfter(3600)->addTags([PLAYER_CONFIG_TAG, $cacheKey]); goto b1itV; S_102: Cc2rC: goto T00a3; j3rAG: $this->requestHeaders = $saveHeaders; goto GuOM3; DMdvV: } private function parseCustomHeaders() { goto vZ1sA; GiMV3: if (!empty($customHeaders)) { goto PSB6u; } goto XqVE6; XqVE6: return; goto BqjQS; J1SzI: PP5u4: goto Oh5Cw; Cr0mG: ksort($customHeaders); goto APJ1K; vZ1sA: session_write_close(); goto qpwcA; qpwcA: $customHeaders = getCustomHeaders($this->url); goto GiMV3; BqjQS: PSB6u: goto Cr0mG; APJ1K: foreach ($customHeaders as $k => $v) { goto s2EIy; ryVlg: ZWlCO: goto pKaPG; KOueK: if ($k === "\x72\x65\x66\x65\x72\145\x72") { goto Ncx3N; } goto dRCTE; cYB7B: $this->origin = $v; goto dWXHN; pokqb: $this->requestHeaders[] = "{$k}\x3a\40{$v}"; goto kAbte; b75Zd: if ($k === "\141\x63\143\145\x70\164\55\x6c\x61\156\147\165\141\x67\145") { goto YZJFJ; } goto J33gb; N3e34: $this->userAgent = $v; goto ryVlg; om7nG: $this->referer = $v; goto DUttl; TqFcf: FojFX: goto N3e34; o3F74: YZJFJ: goto iJrKO; DUttl: goto ZWlCO; goto TqFcf; TT5g_: goto ZWlCO; goto zAKpX; iJrKO: $this->acceptLanguage = $v; goto TT5g_; zAKpX: RJfbF: goto cYB7B; pKaPG: doIgu: goto hwlm5; cRegs: Ncx3N: goto om7nG; dWXHN: goto ZWlCO; goto cRegs; sA9yF: $v = trim($v); goto b75Zd; J33gb: if ($k === "\157\x72\151\x67\151\x6e") { goto RJfbF; } goto KOueK; s2EIy: $k = strtolower(trim($k)); goto sA9yF; dRCTE: if ($k === "\x75\x73\145\162\55\x61\147\145\x6e\x74") { goto FojFX; } goto pokqb; kAbte: goto ZWlCO; goto o3F74; hwlm5: } goto J1SzI; Oh5Cw: } private function changeUrlExtension() { goto t1UQs; fLLDw: $path = parse_url($_SERVER["\x52\105\x51\x55\x45\123\x54\137\x55\122\111"], PHP_URL_PATH); goto m2WC3; rlaPF: $this->url = strtr($this->url, [basename($path) => $originalFilename . "\x2e" . $originalExtension]); goto uLwq6; uLwq6: q2QHq: goto Hw15y; mLql2: list($originalExtension, $originalFilename) = array_pad(explode("\x5f\x67\x78\x5f", pathinfo($path, PATHINFO_FILENAME)), 2, ''); goto rlaPF; m2WC3: if (!(strpos($path, "\x5f\x67\x78\137") !== false)) { goto q2QHq; } goto mLql2; t1UQs: session_write_close(); goto fLLDw; Hw15y: } public function loadHLS() { goto ep7U2; oWWsx: $this->vPlayer = new HLS($this->vHost, $this->vID, $this->url); goto mPodB; ep7U2: session_write_close(); goto r0Kyl; mPodB: $this->load(); goto xplJi; r0Kyl: $this->changeUrlExtension(); goto oWWsx; xplJi: } public function loadMPD() { goto fbhEr; JQ5lf: $this->changeUrlExtension(); goto pMzEF; pMzEF: $this->vPlayer = new MPD($this->vHost, $this->vID, $this->url); goto Py2Tg; fbhEr: session_write_close(); goto JQ5lf; Py2Tg: $this->load(); goto IYzJz; IYzJz: } public function loadMP4() { goto IREI7; ptv0u: $auth = $this->gdAPI->getAccessToken(); goto CL7iG; FWKQG: if (!(strpos($this->url, "\x67\157\x6f\x67\154\x65\141\160\x69\x73\x2e\x63\157\x6d") !== false)) { goto N4gVM; } goto reI0B; F2kVW: $this->vPlayer->setTitle($title); goto INp0W; NCEAz: $this->requestHeaders[] = "\101\165\164\x68\x6f\x72\151\x7a\141\x74\151\157\156\x3a\40" . $auth["\164\157\153\145\x6e\x5f\164\x79\x70\145"] . "\x20" . $auth["\x61\143\143\145\x73\x73\137\164\157\x6b\145\x6e"]; goto LRLMr; CL7iG: if (!$auth) { goto K0O_6; } goto NCEAz; INp0W: $this->load(); goto nmlbt; qdxQh: $this->vPlayer = new MP4($this->vHost, $this->vID, $this->url); goto FWKQG; Hw4wz: N4gVM: goto qMugD; qMugD: $title = trim(pathinfo($this->title, PATHINFO_FILENAME) . "\55" . $this->vLabel, "\x2d\137\x20") . "\56\155\160\x34"; goto F2kVW; IREI7: session_write_close(); goto qdxQh; LRLMr: K0O_6: goto Hw4wz; reI0B: $this->gdAPI->setEmail($this->vEmail); goto ptv0u; nmlbt: } private function load() { goto XSxXg; feY0q: TKp1R: goto Nxt2U; fU4IE: $this->vPlayer->setToken($this->token); goto VQDXR; rIM0T: $this->vPlayer->setHeaders($this->requestHeaders); goto Vf7qG; Vf7qG: $this->vPlayer->setLastModified($this->lastModified); goto D0DbL; Nxt2U: $this->vPlayer->playlistStream(); goto H1DpZ; D0DbL: $this->vPlayer->setMaster($this->isMaster); goto SQ3_H; a3eBF: goto M2tzd; goto feY0q; RhAKr: $this->vPlayer->setCacheFile($this->vLabel); goto rIM0T; VQDXR: if ($this->isMaster) { goto TKp1R; } goto JUoOT; XSxXg: session_write_close(); goto l_iD0; SQ3_H: $this->vPlayer->setSeparator($this->separator); goto fU4IE; l_iD0: $this->requestHeaders = normalizeHeaders($this->requestHeaders); goto RhAKr; H1DpZ: M2tzd: goto uxy0e; JUoOT: $this->vPlayer->stream(); goto a3eBF; uxy0e: } }
