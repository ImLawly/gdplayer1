<?php
/*   __________________________________________________
    |  Obfuscated by YAK Pro - Php Obfuscator  2.0.16  |
    |              on 2025-05-18 20:27:34              |
    |    GitHub: https://github.com/pk-fr/yakpro-po    |
    |__________________________________________________|
*/
/*
Copyright @ 2020 - 2025 GDPlayer v4.7.1. https://gdplayer.to | https://t.me/gdplayerto
*/
 namespace GDPlayer\Hosting; use GDPlayer\{Config, GoogleDriveRestAPI}; use GDPlayer\Model\{GDriveAuth, GDriveQueue}; class Gdrive extends \GDPlayer\CoreExtractor { private $gdAPI; private $gdAuth; private $gdQueue; private $apiURL = "\x68\x74\x74\x70\163\x3a\x2f\x2f\x64\157\143\x73\56\x67\157\x6f\147\154\145\x2e\143\157\155\57\165\57\x30\x2f\x67\145\x74\137\166\x69\144\145\x6f\x5f\151\156\x66\157\x3f\x64\x6f\143\x69\x64\x3d\x25\x73"; private $apiKey = ''; private $hlsMode = false; protected $referer = "\x68\x74\x74\x70\163\x3a\x2f\x2f\x79\x6f\165\x74\x75\x62\x65\x2e\147\x6f\x6f\x67\x6c\x65\141\160\x69\163\x2e\x63\157\155\57"; public function __construct(string $id = '') { goto fRDQB; nTfug: $this->gdQueue->insert(array("\x67\x64\162\151\166\x65\137\x69\x64" => $this->id, "\x64\x65\x6c\x61\x79\x65\x64" => 0)); goto tH3PE; eb4KS: $this->referer = "\x68\x74\164\x70\163\x3a\x2f\x2f\144\162\151\166\145\56\x67\157\x6f\147\154\145\x2e\x63\x6f\x6d\57"; goto GkLZf; x6Yxl: if (!validateBoolean(Config::get("\x67\x64\162\151\x76\145\x5f\143\x6f\160\x79") ?? false)) { goto cy44Q; } goto nTfug; lfbru: $this->gdAPI->setFileID($id); goto VAUDC; GkLZf: parent::__construct($id); goto t6ZJG; RcLXX: $this->hlsMode = validateBoolean(Config::get("\x67\x64\162\x69\166\x65\137\150\154\163")); goto HT0aB; VAUDC: $this->url = sprintf($this->apiURL, $id); goto x6Yxl; SOXNi: $this->gdQueue = GDriveQueue::getInstance(); goto lfbru; HT0aB: $this->cfCustomData["\x68\154\163\115\x6f\144\x65"] = $this->hlsMode; goto eb4KS; tH3PE: cy44Q: goto M1dIP; fRDQB: session_write_close(); goto RcLXX; t6ZJG: $this->gdAPI = new GoogleDriveRestAPI(); goto oYeVa; oYeVa: $this->gdAuth = GDriveAuth::getInstance(); goto SOXNi; M1dIP: } public function setEmail(string $email = '') { goto QqhhS; QqhhS: $this->email = !empty($email) ? $email : getDriveEmail(); goto sWN69; F_s1u: $this->accessToken = $this->gdAPI->getAccessToken(); goto Ae4_j; Ae4_j: $this->apiKey = $this->gdAPI->getAPIKey(); goto eJoJZ; sWN69: $this->gdAPI->setEmail($this->email); goto F_s1u; eJoJZ: } private function createApiResolution(string $id = '', string $label = "\104\145\146\x61\x75\x6c\x74") { goto EVdro; hIbHH: return ["\146\151\154\145" => $url, "\164\x79\x70\x65" => $this->videoType, "\154\x61\142\x65\x6c" => $label]; goto bUlqS; EVdro: $url = "\150\164\164\160\163\72\57\57\x77\167\167\56\x67\x6f\x6f\147\154\145\141\160\x69\163\56\143\x6f\155\57\x64\162\151\166\x65\x2f\x76\x33\57\x66\151\x6c\x65\163\57" . $id . "\x3f\x61\x6c\x74\75\x6d\x65\x64\x69\x61"; goto Cx6Hr; F5Bs9: $url .= "\46\153\145\171\75" . $this->apiKey; goto RKCPX; RKCPX: j4Wbr: goto hIbHH; Cx6Hr: if (empty($this->apiKey)) { goto j4Wbr; } goto F5Bs9; bUlqS: } private function getApiSources(string $id = '') { goto xRIXD; kcWej: if (!empty($this->email)) { goto ZKsYf; } goto f7gdM; xRIXD: $this->id = $id; goto SfYkM; f7gdM: $this->email = getDriveEmail(); goto fWpzU; a5mHa: $this->gdAPI->setEmail($this->email); goto LZxse; fWpzU: ZKsYf: goto a5mHa; s0I98: if (!$this->accessToken) { goto loZ5s; } goto zQo9p; UAZid: $this->getCFSources(); goto eL_ms; zQo9p: $this->cfCustomData["\141\x75\164\150"] = $this->accessToken["\x74\x6f\x6b\145\x6e\137\x74\171\160\x65"] . "\x20" . $this->accessToken["\141\x63\x63\145\163\x73\x5f\x74\157\x6b\x65\x6e"]; goto su3AS; su3AS: loZ5s: goto UAZid; SfYkM: $this->email = $this->getEmailByFileID($id); goto kcWej; LZxse: $this->accessToken = $this->gdAPI->getAccessToken(); goto s0I98; eL_ms: } private function getEmailByFileID(string $id = '') : string { goto g_TFw; C2Grh: $this->gdAPI->setFileID($id); goto M2YZc; lbbgK: $this->gdAPI->setEmail($email); goto C2Grh; wFQgH: nyzTS: goto uLEcd; M2YZc: $fileInfo = $this->gdAPI->getFileInfo(); goto Ik_o7; uLEcd: GR4qw: goto BD_O8; g_TFw: $email = empty($this->email) ? getDriveEmail() : $this->email; goto lbbgK; BD_O8: return $email; goto TK5Ng; PZ678: if (!($this->gdAuth->getNumRows() > 0)) { goto nyzTS; } goto rNU7z; ColxO: $this->gdAuth->setCriteria("\x65\x6d\x61\x69\154", $fileInfo["\x6f\x77\x6e\x65\x72\x73"][0]["\145\x6d\x61\x69\154\101\x64\x64\x72\145\x73\163"]); goto PZ678; Ik_o7: if (empty($fileInfo["\157\x77\x6e\x65\162\163"][0]["\x65\x6d\141\x69\x6c\101\144\x64\x72\x65\x73\x73"])) { goto GR4qw; } goto ColxO; rNU7z: $email = $fileInfo["\157\x77\156\x65\162\163"][0]["\x65\x6d\x61\151\x6c\101\144\x64\x72\x65\163\x73"]; goto wFQgH; TK5Ng: } private function getMirrorFileID() { goto M35S2; oUw94: return $result; goto RX66s; r6L7K: $result = $mirrorFile["\x69\144"]; goto U_g3G; U_g3G: TXIVl: goto oUw94; i0_W5: goto TXIVl; goto OOqY3; M35S2: $result = $this->id; goto sb2sw; vFiFU: $mirrorFile = $this->gdAPI->searchFileMirror(); goto XAM5K; wj93G: ALAd0: goto i0_W5; OOqY3: PQw38: goto U9gUf; dCPB_: $copyFileInfo = $this->gdAPI->copy(); goto eeLpA; eeLpA: if (!$copyFileInfo) { goto ALAd0; } goto FbrE3; sb2sw: $this->gdAPI->setFileID($this->id); goto vFiFU; XAM5K: if (!empty($mirrorFile["\x69\x64"]) && !empty($mirrorFile["\x6f\x77\156\145\x72\x73"][0]["\x65\x6d\x61\x69\x6c\101\144\x64\162\145\x73\163"])) { goto PQw38; } goto dCPB_; FbrE3: $result = $copyFileInfo["\151\144"]; goto wj93G; U9gUf: $this->setEmail($mirrorFile["\157\x77\x6e\145\x72\x73"][0]["\x65\x6d\141\x69\154\101\x64\144\x72\x65\163\163"]); goto r6L7K; RX66s: } private function getLocalSources() { $this->curlRequest(sprintf($this->apiURL, $this->id), [], function ($response) { goto ypfT9; QCq_l: $fmtStreamMap = explode("\x2c", $qry["\146\155\164\137\x73\x74\x72\x65\141\x6d\137\x6d\x61\x70"]); goto Fj5ET; a4fVq: $this->image = $qry["\x69\x75\162\154"]; goto rmA11; rmA11: $this->title = $qry["\164\151\x74\154\145"]; goto QCq_l; dHiHX: if (empty($qry["\146\x6d\164\x5f\x73\164\162\145\141\x6d\137\155\141\160"])) { goto F50Zc; } goto LeOrS; h0xHJ: F50Zc: goto p9Esf; ypfT9: parse_str($response, $qry); goto dHiHX; Fj5ET: $this->sources = array_map(function ($dt) { list($itag, $file) = explode("\174", $dt); return ["\x66\x69\x6c\x65" => $file, "\x74\x79\160\x65" => $this->videoType, "\x6c\x61\x62\145\x6c" => $this->googleLabel($itag)]; }, $fmtStreamMap); goto h0xHJ; LeOrS: $this->status = "\x6f\x6b"; goto a4fVq; p9Esf: }, fn($status, $err) => createErrorLog(["\107\157\x6f\x67\154\145\40\x44\x72\x69\166\x65\x20\x65\162\x72\157\x72", $this->id, $status, $err])); } public function getSources() : array { goto SgWGp; c0a8A: $this->sources[] = ["\146\151\x6c\145" => $last["\x66\151\154\145"], "\164\x79\x70\145" => $last["\x74\x79\x70\x65"], "\154\x61\142\145\x6c" => "\x4f\x72\151\147\151\x6e\x61\154"]; goto wTRTw; ndAXZ: $this->title = $info["\x74\151\x74\154\145"] ?? ''; goto SbpQo; Bd_nX: $this->gdAPI->setFileID($mirrorFileID); goto Ef0dM; y1mLU: $this->referer = "\x68\x74\164\160\163\x3a\x2f\57\x79\x6f\165\x74\x75\x62\x65\x2e\x67\157\157\147\154\x65\141\160\151\x73\x2e\143\157\x6d\x2f"; goto e__98; Ef0dM: $info = $this->gdAPI->getFileInfo(false); goto x0jvD; mR7JI: $this->sources = $this->getNewSources($sources); goto PE0C0; wTRTw: mtMF1: goto NmFfE; RTuNK: $this->getLocalSources(); goto mnhDj; YCrlF: $sources[] = $this->createApiResolution($this->id, "\104\x65\146\x61\165\x6c\164"); goto yR3YI; vS8uj: BF54Y: goto OUWcO; Rq1RL: if (!(!empty($this->sources) && !$this->hlsMode && strpos($this->sources[0]["\146\151\x6c\x65"], "\147\x6f\157\147\154\145\141\x70\151\163\56\x63\157\155") === false)) { goto mtMF1; } goto WF5Pm; rzVib: oVXfD: goto vS8uj; A_enJ: RmrBU: goto cHg1k; x0jvD: $this->status = "\x6f\x6b"; goto ndAXZ; SbpQo: $this->image = "\150\x74\164\x70\163\x3a\x2f\x2f\144\x72\x69\166\x65\x2e\147\x6f\x6f\147\154\x65\x2e\x63\157\x6d\57\x74\x68\x75\155\142\156\141\151\x6c\77\x69\x64\x3d{$mirrorFileID}\x26\x61\x75\x74\150\x75\x73\x65\162\x3d\x30\46\x73\x7a\x3d\x77\x39\71\x39\x39"; goto A712O; NmFfE: return $this->sources; goto Y0ZuP; JMQfw: if (!empty($this->sources)) { goto BF54Y; } goto X_p5x; yR3YI: $sources[] = $this->createApiResolution($this->id, "\x4f\x72\x69\x67\x69\x6e\141\154"); goto mR7JI; mnhDj: EpNRl: goto LAYTz; moANi: $this->cfCustomData["\x68\x6c\x73\115\x6f\x64\145"] = false; goto y1mLU; WF5Pm: $last = end($this->sources); goto yhx9l; SgWGp: if (!$this->isDownloadable) { goto e8fUR; } goto moANi; cHg1k: $this->getApiSources($mirrorFileID); goto rzVib; A712O: $sources = []; goto YCrlF; OUWcO: if (!empty($this->sources)) { goto EpNRl; } goto RTuNK; UUbKQ: goto oVXfD; goto A_enJ; DZacb: e8fUR: goto JMQfw; yhx9l: $this->sources[] = ["\x66\x69\154\145" => $this->sources[0]["\146\151\x6c\145"], "\164\x79\x70\145" => $this->sources[0]["\x74\171\160\145"], "\154\141\142\145\x6c" => "\104\145\146\x61\x75\x6c\164"]; goto c0a8A; LAYTz: if (!empty($this->sources)) { goto uyLTR; } goto Bd_nX; Vg0Ad: $this->getApiSources($this->id); goto UUbKQ; X_p5x: $mirrorFileID = $this->getMirrorFileID(); goto QFCoU; e__98: $this->getApiSources($this->id); goto DZacb; PE0C0: uyLTR: goto Rq1RL; QFCoU: if ($this->id !== $mirrorFileID) { goto RmrBU; } goto Vg0Ad; Y0ZuP: } }
